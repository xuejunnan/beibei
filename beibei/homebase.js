!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Raven=e()}}(function(){var e,t,n;return function i(e,t,n){function o(a,s){if(!t[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=t[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return o(n?n:t)},u,u.exports,i,e,t,n)}return t[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,n){function i(e,t,n,i){return JSON.stringify(e,o(t,i),n)}function o(e,t){var n=[],i=[];return null==t&&(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+i.slice(0,n.indexOf(t)).join(".")+"]"}),function(o,r){if(n.length>0){var a=n.indexOf(this);~a?n.splice(a+1):n.push(this),~a?i.splice(a,1/0,o):i.push(o),~n.indexOf(r)&&(r=t.call(this,o,r))}else n.push(r);return null==e?r:e.call(this,o,r)}}n=t.exports=i,n.getSerialize=o},{}],2:[function(e,t,n){"use strict";function i(e){this.name="RavenConfigError",this.message=e}i.prototype=new Error,i.prototype.constructor=i,t.exports=i},{}],3:[function(e,t,n){"use strict";var i=function(e,t,n){var i=e[t],o=e;if(t in e){var r="warn"===t?"warning":t;e[t]=function(){var e=[].slice.call(arguments),t=""+e.join(" "),a={level:r,logger:"console",extra:{arguments:e}};n&&n(t,a),i&&Function.prototype.apply.call(i,o,e)}}};t.exports={wrapMethod:i}},{}],4:[function(e,t,n){"use strict";function i(){return+new Date}function o(){this._hasJSON=!("object"!=typeof JSON||!JSON.stringify),this._hasDocument=!r(E),this._lastCapturedException=null,this._lastEventId=null,this._globalServer=null,this._globalKey=null,this._globalProject=null,this._globalContext={},this._globalOptions={logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],crossOrigin:"anonymous",collectWindowErrors:!0,maxMessageLength:0,stackTraceLimit:50,autoBreadcrumbs:!0},this._ignoreOnError=0,this._isRavenInstalled=!1,this._originalErrorStackTraceLimit=Error.stackTraceLimit,this._originalConsole=M.console||{},this._originalConsoleMethods={},this._plugins=[],this._startTime=i(),this._wrappedBuiltIns=[],this._breadcrumbs=[],this._lastCapturedEvent=null,this._keypressTimeout,this._location=M.location,this._lastHref=this._location&&this._location.href;for(var e in this._originalConsole)this._originalConsoleMethods[e]=this._originalConsole[e]}function r(e){return void 0===e}function a(e){return"function"==typeof e}function s(e){return"[object String]"===T.toString.call(e)}function c(e){return"object"==typeof e&&null!==e}function l(e){for(var t in e)return!1;return!0}function u(e){var t=T.toString.call(e);return c(e)&&"[object Error]"===t||"[object Exception]"===t||e instanceof Error}function d(e,t){var n,i;if(r(e.length))for(n in e)h(e,n)&&t.call(null,n,e[n]);else if(i=e.length)for(n=0;n<i;n++)t.call(null,n,e[n])}function p(e,t){return t?(d(t,function(t,n){e[t]=n}),e):e}function f(e,t){return!t||e.length<=t?e:e.substr(0,t)+"…"}function h(e,t){return T.hasOwnProperty.call(e,t)}function g(e){for(var t=[],n=0,i=e.length,o;n<i;n++)o=e[n],s(o)?t.push(o.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):o&&o.source&&t.push(o.source);return new RegExp(t.join("|"),"i")}function m(e){var t=[];return d(e,function(e,n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}),t.join("&")}function v(e){var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var n=t[6]||"",i=t[8]||"";return{protocol:t[2],host:t[4],path:t[5],relative:t[5]+n+i}}function w(){var e=window.crypto||window.msCrypto;if(!r(e)&&e.getRandomValues){var t=new Uint16Array(8);e.getRandomValues(t),t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;var n=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return n(t[0])+n(t[1])+n(t[2])+n(t[3])+n(t[4])+n(t[5])+n(t[6])+n(t[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})}function b(e){for(var t=5,n=80,i=[],o=0,r=0,a=" > ",s=a.length,c;e&&o++<t&&(c=_(e),!("html"===c||o>1&&r+i.length*s+c.length>=n));)i.push(c),r+=c.length,e=e.parentNode;return i.reverse().join(a)}function _(e){var t=[],n,i,o,r,a;if(!e||!e.tagName)return"";if(t.push(e.tagName.toLowerCase()),e.id&&t.push("#"+e.id),n=e.className,n&&s(n))for(i=n.split(" "),a=0;a<i.length;a++)t.push("."+i[a]);var c=["type","name","title","alt"];for(a=0;a<c.length;a++)o=c[a],r=e.getAttribute(o),r&&t.push("["+o+'="'+r+'"]');return t.join("")}function x(e,t,n,i){var o=e[t];e[t]=n(o),i&&i.push([e,t,o])}var y=e(6),C=e(2),k=e(1),B=e(3).wrapMethod,S="source protocol user pass host port path".split(" "),$=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/,M="undefined"!=typeof window?window:void 0,E=M&&M.document;o.prototype={VERSION:"3.8.0",debug:!1,TraceKit:y,config:function(e,t){var self=this;if(self._globalServer)return this._logDebug("error","Error: Raven has already been configured"),self;if(!e)return self;var n=self._globalOptions;t&&d(t,function(e,t){"tags"===e||"extra"===e?self._globalContext[e]=t:n[e]=t}),self.setDSN(e),n.ignoreErrors.push(/^Script error\.?$/),n.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),n.ignoreErrors=g(n.ignoreErrors),n.ignoreUrls=!!n.ignoreUrls.length&&g(n.ignoreUrls),n.whitelistUrls=!!n.whitelistUrls.length&&g(n.whitelistUrls),n.includePaths=g(n.includePaths),n.maxBreadcrumbs=Math.max(0,Math.min(n.maxBreadcrumbs||100,100));var i={xhr:!0,console:!0,dom:!0,location:!0},o=n.autoBreadcrumbs;return"[object Object]"==={}.toString.call(o)?o=p(i,o):o!==!1&&(o=i),n.autoBreadcrumbs=o,y.collectWindowErrors=!!n.collectWindowErrors,self},install:function(){var self=this;return self.isSetup()&&!self._isRavenInstalled&&(y.report.subscribe(function(){self._handleOnErrorStackInfo.apply(self,arguments)}),self._instrumentTryCatch(),self._globalOptions.autoBreadcrumbs&&self._instrumentBreadcrumbs(),self._drainPlugins(),self._isRavenInstalled=!0),Error.stackTraceLimit=self._globalOptions.stackTraceLimit,this},setDSN:function(e){var self=this,t=self._parseDSN(e),n=t.path.lastIndexOf("/"),i=t.path.substr(1,n);self._dsn=e,self._globalKey=t.user,self._globalSecret=t.pass&&t.pass.substr(1),self._globalProject=t.path.substr(n+1),self._globalServer=self._getGlobalServer(t),self._globalEndpoint=self._globalServer+"/"+i+"api/"+self._globalProject+"/store/"},context:function(e,t,n){return a(e)&&(n=t||[],t=e,e=void 0),this.wrap(e,t).apply(this,n)},wrap:function(e,t,n){function i(){var i=[],o=arguments.length,r=!e||e&&e.deep!==!1;for(n&&a(n)&&n.apply(this,arguments);o--;)i[o]=r?self.wrap(e,arguments[o]):arguments[o];try{return t.apply(this,i)}catch(s){throw self._ignoreNextOnError(),self.captureException(s,e),s}}var self=this;if(r(t)&&!a(e))return e;if(a(e)&&(t=e,e=void 0),!a(t))return t;try{if(t.__raven__)return t;if(t.__raven_wrapper__)return t.__raven_wrapper__}catch(o){return t}for(var s in t)h(t,s)&&(i[s]=t[s]);return i.prototype=t.prototype,t.__raven_wrapper__=i,i.__raven__=!0,i.__inner__=t,i},uninstall:function(){return y.report.uninstall(),this._restoreBuiltIns(),Error.stackTraceLimit=this._originalErrorStackTraceLimit,this._isRavenInstalled=!1,this},captureException:function(e,t){if(!u(e))return this.captureMessage(e,p({trimHeadFrames:1,stacktrace:!0},t));this._lastCapturedException=e;try{var n=y.computeStackTrace(e);this._handleStackInfo(n,t)}catch(i){if(e!==i)throw i}return this},captureMessage:function(e,t){if(!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(e)){var n=p({message:e+""},t);if(t&&t.stacktrace){var i;try{throw new Error(e)}catch(o){i=o}i.name=null,t=p({fingerprint:e,trimHeadFrames:(t.trimHeadFrames||0)+1},t);var r=y.computeStackTrace(i),a=this._prepareFrames(r,t);n.stacktrace={frames:a.reverse()}}return this._send(n),this}},captureBreadcrumb:function(e){var t=p({timestamp:i()/1e3},e);return this._breadcrumbs.push(t),this._breadcrumbs.length>this._globalOptions.maxBreadcrumbs&&this._breadcrumbs.shift(),this},addPlugin:function(e){var t=[].slice.call(arguments,1);return this._plugins.push([e,t]),this._isRavenInstalled&&this._drainPlugins(),this},setUserContext:function(e){return this._globalContext.user=e,this},setExtraContext:function(e){return this._mergeContext("extra",e),this},setTagsContext:function(e){return this._mergeContext("tags",e),this},clearContext:function(){return this._globalContext={},this},getContext:function(){return JSON.parse(k(this._globalContext))},setEnvironment:function(e){return this._globalOptions.environment=e,this},setRelease:function(e){return this._globalOptions.release=e,this},setDataCallback:function(e){var t=this._globalOptions.dataCallback;return this._globalOptions.dataCallback=a(e)?function(n){return e(n,t)}:e,this},setShouldSendCallback:function(e){var t=this._globalOptions.shouldSendCallback;return this._globalOptions.shouldSendCallback=a(e)?function(n){return e(n,t)}:e,this},setTransport:function(e){return this._globalOptions.transport=e,this},lastException:function(){return this._lastCapturedException},lastEventId:function(){return this._lastEventId},isSetup:function(){return!!this._hasJSON&&(!!this._globalServer||(this.ravenNotConfiguredError||(this.ravenNotConfiguredError=!0,this._logDebug("error","Error: Raven has not been configured.")),!1))},afterLoad:function(){var e=M.RavenConfig;e&&this.config(e.dsn,e.config).install()},showReportDialog:function(e){if(E){e=e||{};var t=e.eventId||this.lastEventId();if(!t)throw new C("Missing eventId");var n=e.dsn||this._dsn;if(!n)throw new C("Missing DSN");var i=encodeURIComponent,o="";o+="?eventId="+i(t),o+="&dsn="+i(n);var r=e.user||this._globalContext.user;r&&(r.name&&(o+="&name="+i(r.name)),r.email&&(o+="&email="+i(r.email)));var a=this._getGlobalServer(this._parseDSN(n)),s=E.createElement("script");s.async=!0,s.src=a+"/api/embed/error-page/"+o,(E.head||E.body).appendChild(s)}},_ignoreNextOnError:function(){var self=this;this._ignoreOnError+=1,setTimeout(function(){self._ignoreOnError-=1})},_triggerEvent:function(e,t){var n,i;if(this._hasDocument){t=t||{},e="raven"+e.substr(0,1).toUpperCase()+e.substr(1),E.createEvent?(n=E.createEvent("HTMLEvents"),n.initEvent(e,!0,!0)):(n=E.createEventObject(),n.eventType=e);for(i in t)h(t,i)&&(n[i]=t[i]);if(E.createEvent)E.dispatchEvent(n);else try{E.fireEvent("on"+n.eventType.toLowerCase(),n)}catch(o){}}},_breadcrumbEventHandler:function(e){var self=this;return function(t){if(self._keypressTimeout=null,self._lastCapturedEvent!==t){self._lastCapturedEvent=t;var n=t.target,i;try{i=b(n)}catch(o){i="<unknown>"}self.captureBreadcrumb({category:"ui."+e,message:i})}}},_keypressEventHandler:function(){var self=this,e=1e3;return function(t){var n=t.target,i=n&&n.tagName;if(i&&("INPUT"===i||"TEXTAREA"===i||n.isContentEditable)){var o=self._keypressTimeout;o||self._breadcrumbEventHandler("input")(t),clearTimeout(o),self._keypressTimeout=setTimeout(function(){self._keypressTimeout=null},e)}}},_captureUrlChange:function(e,t){var n=v(this._location.href),i=v(t),o=v(e);this._lastHref=t,n.protocol===i.protocol&&n.host===i.host&&(t=i.relative),n.protocol===o.protocol&&n.host===o.host&&(e=o.relative),this.captureBreadcrumb({category:"navigation",data:{to:t,from:e}})},_instrumentTryCatch:function(){function e(e){return function(t,n){for(var i=new Array(arguments.length),o=0;o<i.length;++o)i[o]=arguments[o];var r=i[0];return a(r)&&(i[0]=self.wrap(r)),e.apply?e.apply(this,i):e(i[0],i[1])}}function t(e){var t=M[e]&&M[e].prototype;t&&t.hasOwnProperty&&t.hasOwnProperty("addEventListener")&&(x(t,"addEventListener",function(t){return function(n,o,r,a){try{o&&o.handleEvent&&(o.handleEvent=self.wrap(o.handleEvent))}catch(s){}var c;return i&&i.dom&&("EventTarget"===e||"Node"===e)&&("click"===n?c=self._breadcrumbEventHandler(n):"keypress"===n&&(c=self._keypressEventHandler())),t.call(this,n,self.wrap(o,void 0,c),r,a)}},n),x(t,"removeEventListener",function(e){return function(t,n,i,o){try{n=n&&(n.__raven_wrapper__?n.__raven_wrapper__:n)}catch(r){}return e.call(this,t,n,i,o)}},n))}var self=this,n=self._wrappedBuiltIns,i=this._globalOptions.autoBreadcrumbs;x(M,"setTimeout",e,n),x(M,"setInterval",e,n),M.requestAnimationFrame&&x(M,"requestAnimationFrame",function(e){return function(t){return e(self.wrap(t))}},n);for(var o=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],r=0;r<o.length;r++)t(o[r]);var s=M.jQuery||M.$;s&&s.fn&&s.fn.ready&&x(s.fn,"ready",function(e){return function(t){return e.call(this,self.wrap(t))}},n)},_instrumentBreadcrumbs:function(){function e(e,t){e in t&&a(t[e])&&x(t,e,function(e){return self.wrap(e)})}var self=this,t=this._globalOptions.autoBreadcrumbs,n=self._wrappedBuiltIns;if(t.xhr&&"XMLHttpRequest"in M){var i=XMLHttpRequest.prototype;x(i,"open",function(e){return function(t,n){return s(n)&&n.indexOf(self._globalKey)===-1&&(this.__raven_xhr={method:t,url:n,status_code:null}),e.apply(this,arguments)}},n),x(i,"send",function(t){return function(n){function i(){if(o.__raven_xhr&&(1===o.readyState||4===o.readyState)){try{o.__raven_xhr.status_code=o.status}catch(e){}self.captureBreadcrumb({type:"http",category:"xhr",data:o.__raven_xhr})}}for(var o=this,r=["onload","onerror","onprogress"],s=0;s<r.length;s++)e(r[s],o);return"onreadystatechange"in o&&a(o.onreadystatechange)?x(o,"onreadystatechange",function(e){return self.wrap(e,void 0,i)}):o.onreadystatechange=i,t.apply(this,arguments)}},n)}t.xhr&&"fetch"in M&&x(M,"fetch",function(e){return function(t,n){for(var i=new Array(arguments.length),o=0;o<i.length;++o)i[o]=arguments[o];var r="GET";i[1]&&i[1].method&&(r=i[1].method);var a={method:r,url:i[0],status_code:null};return self.captureBreadcrumb({type:"http",category:"fetch",data:a}),e.apply(this,i).then(function(e){return a.status_code=e.status,e})}},n),t.dom&&this._hasDocument&&(E.addEventListener?(E.addEventListener("click",self._breadcrumbEventHandler("click"),!1),E.addEventListener("keypress",self._keypressEventHandler(),!1)):(E.attachEvent("onclick",self._breadcrumbEventHandler("click")),E.attachEvent("onkeypress",self._keypressEventHandler())));var o=M.chrome,r=o&&o.app&&o.app.runtime,c=!r&&M.history&&history.pushState;if(t.location&&c){var l=M.onpopstate;M.onpopstate=function(){var e=self._location.href;if(self._captureUrlChange(self._lastHref,e),l)return l.apply(this,arguments)},x(history,"pushState",function(e){return function(){var t=arguments.length>2?arguments[2]:void 0;return t&&self._captureUrlChange(self._lastHref,t+""),e.apply(this,arguments)}},n)}if(t.console&&"console"in M&&console.log){var u=function(e,t){self.captureBreadcrumb({message:e,level:t.level,category:"console"})};d(["debug","info","warn","error","log"],function(e,t){B(console,t,u)})}},_restoreBuiltIns:function(){for(var e;this._wrappedBuiltIns.length;){e=this._wrappedBuiltIns.shift();var t=e[0],n=e[1],i=e[2];t[n]=i}},_drainPlugins:function(){var self=this;d(this._plugins,function(e,t){var n=t[0],i=t[1];n.apply(self,[self].concat(i))})},_parseDSN:function(e){var t=$.exec(e),n={},i=7;try{for(;i--;)n[S[i]]=t[i]||""}catch(o){throw new C("Invalid DSN: "+e)}if(n.pass&&!this._globalOptions.allowSecretKey)throw new C("Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key");return n},_getGlobalServer:function(e){var t="//"http://st.beibei.com/static/build/js/8ac592096em/+e.host+(e.port?":"+e.port:"");return e.protocol&&(t=e.protocol+":"+t),t},_handleOnErrorStackInfo:function(){this._ignoreOnError||this._handleStackInfo.apply(this,arguments)},_handleStackInfo:function(e,t){var n=this._prepareFrames(e,t);this._triggerEvent("handle",{stackInfo:e,options:t}),this._processException(e.name,e.message,e.url,e.lineno,n,t)},_prepareFrames:function(e,t){var self=this,n=[];if(e.stack&&e.stack.length&&(d(e.stack,function(e,t){var i=self._normalizeFrame(t);i&&n.push(i)}),t&&t.trimHeadFrames))for(var i=0;i<t.trimHeadFrames&&i<n.length;i++)n[i].in_app=!1;return n=n.slice(0,this._globalOptions.stackTraceLimit)},_normalizeFrame:function(e){if(e.url){var t={filename:e.url,lineno:e.line,colno:e.column,"function":e.func||"?"};return t.in_app=!(this._globalOptions.includePaths.test&&!this._globalOptions.includePaths.test(t.filename)||/(Raven|TraceKit)\./.test(t["function"])||/raven\.(min\.)?js$/.test(t.filename)),t}},_processException:function(e,t,n,i,o,r){var a;if((!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(t))&&(t+="",o&&o.length?(n=o[0].filename||n,o.reverse(),a={frames:o}):n&&(a={frames:[{filename:n,lineno:i,in_app:!0}]}),(!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(n))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(n)))){var s=p({exception:{values:[{type:e,value:t,stacktrace:a}]},culprit:n},r);this._send(s)}},_trimPacket:function(e){var t=this._globalOptions.maxMessageLength;if(e.message&&(e.message=f(e.message,t)),e.exception){var n=e.exception.values[0];n.value=f(n.value,t)}return e},_getHttpData:function(){if(this._hasDocument&&E.location&&E.location.href){var e={headers:{"User-Agent":navigator.userAgent}};return e.url=E.location.href,E.referrer&&(e.headers.Referer=E.referrer),e}},_send:function(e){var t=this._globalOptions,n={project:this._globalProject,logger:t.logger,platform:"javascript"},o=this._getHttpData();o&&(n.request=o),e.trimHeadFrames&&delete e.trimHeadFrames,e=p(n,e),e.tags=p(p({},this._globalContext.tags),e.tags),e.extra=p(p({},this._globalContext.extra),e.extra),e.extra["session:duration"]=i()-this._startTime,this._breadcrumbs&&this._breadcrumbs.length>0&&(e.breadcrumbs={values:[].slice.call(this._breadcrumbs,0)}),l(e.tags)&&delete e.tags,this._globalContext.user&&(e.user=this._globalContext.user),t.environment&&(e.environment=t.environment),t.release&&(e.release=t.release),t.serverName&&(e.server_name=t.serverName),a(t.dataCallback)&&(e=t.dataCallback(e)||e),e&&!l(e)&&(a(t.shouldSendCallback)&&!t.shouldSendCallback(e)||this._sendProcessedPayload(e))},_getUuid:function(){return w()},_sendProcessedPayload:function(e,t){var self=this,n=this._globalOptions;if(this._lastEventId=e.event_id||(e.event_id=this._getUuid()),e=this._trimPacket(e),this._logDebug("debug","Raven about to send:",e),this.isSetup()){var i={sentry_version:"7",sentry_client:"raven-js/"+this.VERSION,sentry_key:this._globalKey};this._globalSecret&&(i.sentry_secret=this._globalSecret);var o=e.exception&&e.exception.values[0];this.captureBreadcrumb({category:"sentry",message:o?(o.type?o.type+": ":"")+o.value:e.message,event_id:e.event_id,level:e.level||"error"});var r=this._globalEndpoint;(n.transport||this._makeRequest).call(this,{url:r,auth:i,data:e,options:n,onSuccess:function a(){self._triggerEvent("success",{data:e,src:r}),t&&t()},onError:function s(n){self._triggerEvent("failure",{data:e,src:r}),n=n||new Error("Raven send failed (no additional details provided)"),t&&t(n)}})}},_makeRequest:function(e){function t(){200===n.status?e.onSuccess&&e.onSuccess():e.onError&&e.onError(new Error("Sentry error code: "+n.status))}var n=new XMLHttpRequest,i="withCredentials"in n||"undefined"!=typeof XDomainRequest;if(i){var o=e.url;"withCredentials"in n?n.onreadystatechange=function(){4===n.readyState&&t()}:(n=new XDomainRequest,o=o.replace(/^https?:/,""),n.onload=t),n.open("POST",o+"?"+m(e.auth)),n.send(k(e.data))}},_logDebug:function(e){this._originalConsoleMethods[e]&&this.debug&&Function.prototype.apply.call(this._originalConsoleMethods[e],this._originalConsole,[].slice.call(arguments,1))},_mergeContext:function(e,t){r(t)?delete this._globalContext[e]:this._globalContext[e]=p(this._globalContext[e]||{},t)}};var T=Object.prototype;"undefined"!=typeof __DEV__&&__DEV__&&(o.utils={isUndefined:r,isFunction:a,isString:s,isObject:c,isEmptyObject:l,isError:u,each:d,objectMerge:p,truncate:f,hasKey:h,joinRegExp:g,urlencode:m,uuid4:w,htmlTreeAsString:b,htmlElementAsString:_,parseUrl:v,fill:x}),o.prototype.setUser=o.prototype.setUserContext,o.prototype.setReleaseContext=o.prototype.setRelease,t.exports=o},{1:1,2:2,3:3,6:6}],5:[function(e,t,n){"use strict";var i=e(4),o=window.Raven,r=new i;r.noConflict=function(){return window.Raven=o,r},r.afterLoad(),t.exports=r},{4:4}],6:[function(e,t,n){"use strict";function i(){return"undefined"==typeof document?"":document.location.href}var o={collectWindowErrors:!0,debug:!1},r=[].slice,a="?",s=/^(?:Uncaught (?:exception: )?)?((?:Eval|Internal|Range|Reference|Syntax|Type|URI)Error): ?(.*)$/;o.report=function c(){function e(e){u(),h.push(e)}function t(e){for(var t=h.length-1;t>=0;--t)h[t]===e&&h.splice(t,1)}function n(){d(),h=[]}function c(e,t){var n=null;if(!t||o.collectWindowErrors){for(var i in h)if(h.hasOwnProperty(i))try{h[i].apply(null,[e].concat(r.call(arguments,2)))}catch(a){n=a}if(n)throw n}}function l(e,t,n,r,l){var u=null;if(v)o.computeStackTrace.augmentStackTraceWithInitialElement(v,t,n,e),p();else if(l)u=o.computeStackTrace(l),c(u,!0);else{var d={url:t,line:n,column:r},f=void 0,h=e,g;if("[object String]"==={}.toString.call(e)){var g=e.match(s);g&&(f=g[1],h=g[2])}d.func=a,u={name:f,message:h,url:i(),stack:[d]},c(u,!0)}return!!w&&w.apply(this,arguments)}function u(){b||(w=window.onerror,window.onerror=l,b=!0)}function d(){b&&(window.onerror=w,b=!1,w=void 0)}function p(){var e=v,t=g;g=null,v=null,m=null,c.apply(null,[e,!1].concat(t))}function f(e,t){var n=r.call(arguments,1);if(v){if(m===e)return;p()}var i=o.computeStackTrace(e);if(v=i,m=e,g=n,setTimeout(function(){m===e&&p()},i.incomplete?2e3:0),t!==!1)throw e}var h=[],g=null,m=null,v=null,w,b;return f.subscribe=e,f.unsubscribe=t,f.uninstall=n,f}(),o.computeStackTrace=function l(){function e(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function t(t){return e(t).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function n(e){if("undefined"!=typeof e.stack&&e.stack){for(var t=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|<anonymous>).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,n=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|\[native).*?)(?::(\d+))?(?::(\d+))?\s*$/i,o=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,r=e.stack.split("\n"),s=[],c,l,u=/^(.*) is undefined$/.exec(e.message),d=0,p=r.length;d<p;++d){if(c=t.exec(r[d])){var f=c[2]&&c[2].indexOf("native")!==-1;l={url:f?null:c[2],func:c[1]||a,args:f?[c[2]]:[],line:c[3]?+c[3]:null,column:c[4]?+c[4]:null}}else if(c=o.exec(r[d]))l={url:c[2],func:c[1]||a,args:[],line:+c[3],column:c[4]?+c[4]:null};else{if(!(c=n.exec(r[d])))continue;l={url:c[3],func:c[1]||a,args:c[2]?c[2].split(","):[],line:c[4]?+c[4]:null,column:c[5]?+c[5]:null}}!l.func&&l.line&&(l.func=a),s.push(l)}return s.length?(s[0].column||"undefined"==typeof e.columnNumber||(s[0].column=e.columnNumber+1),{name:e.name,message:e.message,url:i(),stack:s}):null}}function r(e,t,n,i){var o={url:t,line:n};if(o.url&&o.line){if(e.incomplete=!1,o.func||(o.func=a),e.stack.length>0&&e.stack[0].url===o.url){if(e.stack[0].line===o.line)return!1;if(!e.stack[0].line&&e.stack[0].func===o.func)return e.stack[0].line=o.line,!1}return e.stack.unshift(o),e.partial=!0,!0}return e.incomplete=!0,!1}function s(e,t){for(var n=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,l=[],u={},d=!1,p,f,h,g=s.caller;g&&!d;g=g.caller)if(g!==c&&g!==o.report){if(f={url:null,func:a,line:null,column:null},g.name?f.func=g.name:(p=n.exec(g.toString()))&&(f.func=p[1]),"undefined"==typeof f.func)try{f.func=p.input.substring(0,p.input.indexOf("{"))}catch(m){}u[""+g]?d=!0:u[""+g]=!0,l.push(f)}t&&l.splice(0,t);var v={name:e.name,message:e.message,url:i(),stack:l};return r(v,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),v}function c(e,t){var r=null;t=null==t?0:+t;try{if(r=n(e))return r}catch(a){if(o.debug)throw a}try{if(r=s(e,t+1))return r}catch(a){if(o.debug)throw a}return{name:e.name,message:e.message,url:i()}}return c.augmentStackTraceWithInitialElement=r,c.computeStackTraceFromStackProp=n,c}(),t.exports=o},{}]},{},[5])(5)}),function(e){if(!e.devMode){var t={ignoreErrors:["Cannot read property 'complete' of null",/Can\'t find variable: MyAppGetLink*/],ignoreUrls:[],sampleRate:.2},n={};Raven.config("https://a065842612374a6f8baa38ff650c43cc@js.str.hucdn.com/18",t).install(),n.info=function(e){Raven.captureMessage(JSON.stringify(e),{level:"info"})},n.warn=function(e){Raven.captureMessage(JSON.stringify(e),{level:"warning"})},n.error=function(e){Raven.captureException(new Error(JSON.stringify(e)),{level:"error"})},n.fatal=function(e,t){Raven.captureException(new Error(JSON.stringify(e)),{level:"fatal",tags:{business:t||"public"}})},e.sentry=n}}(window);var md5=function(e){var t=function(e){return"[object String]"===Object.prototype.toString.call(e)};t(e)||(e=e.toString());var n=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t},i,o=function(e,t){return e<<t|e>>>32-t},r=function(e,t){var n,i,o,r,a;return o=2147483648&e,r=2147483648&t,n=1073741824&e,i=1073741824&t,a=(1073741823&e)+(1073741823&t),n&i?2147483648^a^o^r:n|i?1073741824&a?3221225472^a^o^r:1073741824^a^o^r:a^o^r},a=function(e,t,n){return e&t|~e&n},s=function(e,t,n){return e&n|t&~n},c=function(e,t,n){return e^t^n},l=function(e,t,n){return t^(e|~n)},u=function(e,t,n,i,s,c,l){return e=r(e,r(r(a(t,n,i),s),l)),r(o(e,c),t)},d=function(e,t,n,i,a,c,l){return e=r(e,r(r(s(t,n,i),a),l)),r(o(e,c),t)},p=function(e,t,n,i,a,s,l){return e=r(e,r(r(c(t,n,i),a),l)),r(o(e,s),t)},f=function(e,t,n,i,a,s,c){return e=r(e,r(r(l(t,n,i),a),c)),r(o(e,s),t)},h=function(e){for(var t,n=e.length,i=n+8,o=(i-i%64)/64,r=16*(o+1),a=new Array(r-1),s=0,c=0;c<n;)t=(c-c%4)/4,s=c%4*8,a[t]=a[t]|e.charCodeAt(c)<<s,c++;return t=(c-c%4)/4,s=c%4*8,a[t]=a[t]|128<<s,a[r-2]=n<<3,a[r-1]=n>>>29,a},g=function(e){var t="",n="",i,o;for(o=0;o<=3;o++)i=e>>>8*o&255,n="0"+i.toString(16),t+=n.substr(n.length-2,2);return t},m=[],v,w,b,_,x,y,C,k,B,S=7,$=12,M=17,E=22,T=5,I=9,L=14,j=20,O=4,N=11,P=16,F=23,R=6,U=10,D=15,A=21;for(e=n(e),m=h(e),y=1732584193,C=4023233417,k=2562383102,B=271733878,i=m.length,v=0;v<i;v+=16)w=y,b=C,_=k,x=B,y=u(y,C,k,B,m[v+0],S,3614090360),B=u(B,y,C,k,m[v+1],$,3905402710),k=u(k,B,y,C,m[v+2],M,606105819),C=u(C,k,B,y,m[v+3],E,3250441966),y=u(y,C,k,B,m[v+4],S,4118548399),B=u(B,y,C,k,m[v+5],$,1200080426),k=u(k,B,y,C,m[v+6],M,2821735955),C=u(C,k,B,y,m[v+7],E,4249261313),y=u(y,C,k,B,m[v+8],S,1770035416),B=u(B,y,C,k,m[v+9],$,2336552879),k=u(k,B,y,C,m[v+10],M,4294925233),C=u(C,k,B,y,m[v+11],E,2304563134),y=u(y,C,k,B,m[v+12],S,1804603682),B=u(B,y,C,k,m[v+13],$,4254626195),k=u(k,B,y,C,m[v+14],M,2792965006),C=u(C,k,B,y,m[v+15],E,1236535329),y=d(y,C,k,B,m[v+1],T,4129170786),B=d(B,y,C,k,m[v+6],I,3225465664),k=d(k,B,y,C,m[v+11],L,643717713),C=d(C,k,B,y,m[v+0],j,3921069994),y=d(y,C,k,B,m[v+5],T,3593408605),B=d(B,y,C,k,m[v+10],I,38016083),k=d(k,B,y,C,m[v+15],L,3634488961),C=d(C,k,B,y,m[v+4],j,3889429448),y=d(y,C,k,B,m[v+9],T,568446438),B=d(B,y,C,k,m[v+14],I,3275163606),k=d(k,B,y,C,m[v+3],L,4107603335),C=d(C,k,B,y,m[v+8],j,1163531501),y=d(y,C,k,B,m[v+13],T,2850285829),B=d(B,y,C,k,m[v+2],I,4243563512),k=d(k,B,y,C,m[v+7],L,1735328473),C=d(C,k,B,y,m[v+12],j,2368359562),y=p(y,C,k,B,m[v+5],O,4294588738),B=p(B,y,C,k,m[v+8],N,2272392833),k=p(k,B,y,C,m[v+11],P,1839030562),C=p(C,k,B,y,m[v+14],F,4259657740),y=p(y,C,k,B,m[v+1],O,2763975236),B=p(B,y,C,k,m[v+4],N,1272893353),k=p(k,B,y,C,m[v+7],P,4139469664),C=p(C,k,B,y,m[v+10],F,3200236656),y=p(y,C,k,B,m[v+13],O,681279174),B=p(B,y,C,k,m[v+0],N,3936430074),k=p(k,B,y,C,m[v+3],P,3572445317),C=p(C,k,B,y,m[v+6],F,76029189),y=p(y,C,k,B,m[v+9],O,3654602809),B=p(B,y,C,k,m[v+12],N,3873151461),k=p(k,B,y,C,m[v+15],P,530742520),C=p(C,k,B,y,m[v+2],F,3299628645),y=f(y,C,k,B,m[v+0],R,4096336452),B=f(B,y,C,k,m[v+7],U,1126891415),k=f(k,B,y,C,m[v+14],D,2878612391),C=f(C,k,B,y,m[v+5],A,4237533241),y=f(y,C,k,B,m[v+12],R,1700485571),B=f(B,y,C,k,m[v+3],U,2399980690),k=f(k,B,y,C,m[v+10],D,4293915773),C=f(C,k,B,y,m[v+1],A,2240044497),y=f(y,C,k,B,m[v+8],R,1873313359),B=f(B,y,C,k,m[v+15],U,4264355552),k=f(k,B,y,C,m[v+6],D,2734768916),C=f(C,k,B,y,m[v+13],A,1309151649),y=f(y,C,k,B,m[v+4],R,4149444226),B=f(B,y,C,k,m[v+11],U,3174756917),k=f(k,B,y,C,m[v+2],D,718787259),C=f(C,k,B,y,m[v+9],A,3951481745),y=r(y,w),C=r(C,b),k=r(k,_),B=r(B,x);var q=g(y)+g(C)+g(k)+g(B);return q.toLowerCase()};!function(){var e=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},t=function(e){return"[object String]"===Object.prototype.toString.call(e)};$.ajaxPrefilter(function(n,i,o){var r,a,s;if(n.type&&n.type.toUpperCase&&"POST"===n.type.toUpperCase())if(r=$.cookie("hxcsrf"),r||(a=$.now(),r=md5(a+e(1,1e8)),$.cookie("hxcsrf",r,{expires:(new Date).setTime(a+6e5)})),s=n.data,$.isPlainObject(s))s.hxcsrf=r;else if(t(n.data))s?s.search("hxcsrf")===-1?n.data+="&hxcsrf="+r:n.data=s.replace(/hxcsrf=([A-Za-z\d]*)/g,"hxcsrf="+r):n.data+="hxcsrf="+r;else if($.isArray(s)){var c=!1;$.each(s,function(e){"hxcsrf"===e.name&&(c=!0,e.value=r)}),c||s.push({name:"hxcsrf",value:r})}else s||(n.data="hxcsrf="+r)})}();var B={};B.Core={positionFooter:function(){var e=$("#footer");e.hasClass("fix")&&document.documentElement.clientHeight-e.outerHeight()<document.documentElement.offsetHeight?e.removeClass("fix"):document.documentElement.clientHeight>document.documentElement.offsetHeight&&e.addClass("fix")},isPlainObject:function(e){return!(!_.isObject(e)||_.isArray(e)||_.isFunction(e)||_.isElement(e)||_.isArguments(e)||_.isDate(e)||_.isRegExp(e))},newQuote:function(e){return B.Core.isPlainObject(e)?$.extend(!0,{},e):_.isArray(e)?$.extend(!0,[],e):e},setObject:function(e,t,n){var i=e;return"this"===t?e=n:(t=t.split("."),_.each(t,function(e,o){o<t.length-1?(_.isObject(i[e])||(i[e]={}),i=i[e]):o===t.length-1&&(i[e]=n)}),e)},getObject:function(e,t){var n=e,i;return"this"===t?i=n:(t=t.split("."),_.each(t,function(e,o){if(o<t.length-1)try{n=n[e]}catch(r){}else if(o===t.length-1)try{i=n[e]}catch(r){}}),i)},getObjectKeyList:function(e){var t=[];return _.each(e,function(e,n){/^_/g.test(n)||t.push(n)}),t},makeClass:function(){var e=function(){};return e.needMixinProperty={isClass:!0,toString:function(){return"B Class"},mixinProperty:function(){var self=this,e=!!self.superClass;return _.isUndefined(self.property)&&(self.property={}),_.each(self.needMixinProperty,function(t,n){self.needMixinProperty.hasOwnProperty(n)&&(e&&_.isFunction(t)&&_.isFunction(self.superClass[n])&&/(this|self)\._super/.test(t)?self.property[n]=function(e,t){var n=self.superClass[e];return function(){return this._super=n,t.apply(this,arguments)}}(n,t):e&&B.Core.isPlainObject(t)&&B.Core.isPlainObject(self.superClass[n])?$.extend(!0,self.property[n],self.superClass[n],t):self.property[n]=t,self[n]=self.property[n])}),delete self.needMixinProperty,self},mixinPrototype:function(){var self=this,e=!!self.superProto;return _.each(self.needMixinPrototype,function(t,n){self.needMixinPrototype.hasOwnProperty(n)&&(e&&_.isFunction(t)&&_.isFunction(self.superProto[n])&&/(this|self)\._super/.test(t)?self.prototype[n]=function(e,t){var n=self.superProto[e];return function(){return this._super=n,t.apply(this,arguments);
}}(n,t):e&&B.Core.isPlainObject(t)&&B.Core.isPlainObject(self.superProto[n])?self.prototype[n]=$.extend(!0,{},self.superProto[n],t):self.prototype[n]=t)}),delete self.needMixinPrototype,self},reopenClass:function(t,n){return t=t||{},n=n||e,this.superClass=B.Core.newQuote(n.property),this.needMixinProperty=t,this.mixinProperty(),this},reopen:function(t,n){return t=t||{},n=n||e,this.superProto=B.Core.newQuote(n.prototype),this.needMixinPrototype=t,this.mixinPrototype(),this},extend:function(e){var self=this;e=e||{};var t=B.Core.makeClass();return t.reopenClass(self.property,self),t.reopen(self.prototype,self).reopen(e,self),t},create:function(e,t){var n=new this;_.each(e,function(e,t){B.Core.isPlainObject(n[t])?n[t]=$.extend(!0,{},n[t],e):n[t]=e});for(var i in n)/^\_self\_/g.test(i)&&(n[i.replace(/^\_self\_/g,"")]=B.Core.newQuote(n[i]));return _.isFunction(t)&&t(n),n.init(),n}},e.needMixinPrototype={constructor:e,init:function(){}},e.needMixinProperty.mixinProperty.apply(e,arguments),e.mixinPrototype(),e}},window.String.prototype.firstUpperCase=function(){var e=this.toString().replace(/^\w+/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)});return e};var H=B.H={isLogin:function(){return null!==$.cookie("st_au")},lastLoginId:function(){return $.cookie("_last_login_id_")}};window.Function.prototype.mix=function(){var e=this,t=function(){return e.apply(this)};return t.needCalculate=!0,t},B.Object=B.Core.makeClass(),B.Object.reopenClass({}),B.Object.reopen({_self__watchStack:[],_self__mixStack:{},_self__watchSelfStack:[],init:function(){this._super();var self=this;self.mountMixValue(),self.mountBindValue(),self.watch("this",function(e,t,self){self.makeMix(),_.each(self._watchSelfStack,function(n){n(e,t,self)})},!0),self.makeMix(),self._watchStack[0].last=$.extend(!0,{},self),self.callIns()},use:function(e){var t=_.rest(arguments),n=B.Core.getObject(this,e);return _.isUndefined(n)?void 0:n.apply(this,t)},set:function(e,t){return B.Core.setObject(this,e,t),this.digest(),this},get:function(e){var t=B.Core.getObject(this,e);return t},mountMixValue:function(){var self=this,e=function(){self[this.mixKey]=this.mixFun.apply(self)};if(B.Core.isPlainObject(self))for(var t in self){var n=self[t];if(_.isFunction(n)&&n.needCalculate===!0){var i={mixFun:n,mixKey:t,main:e};self._mixStack[i.mixKey]=i}}},mountBindValue:function(){var self=this;for(var e in self){var t=self[e];_.isFunction(t)&&t.needBind===!0&&self.set(e,t(self,e))}},makeMix:function(){var self=this;_.each(self._mixStack,function(e){try{e.main()}catch(t){}})},setMix:function(e,t){var self=this,n=function(){self[this.mixKey]=this.mixFun(self)},i={mixFun:function(self){return t.apply(self)},mixKey:e,main:n};return self._mixStack[i.mixKey]=i,self.makeMix(self),this},watchSelf:function(e){this._watchSelfStack.push(e)},watch:function(e,t,n){var i,self=this;if(_.isString(e)){var o=e;e=function(self){var e=B.Core.getObject(self,o);return e}}var r={watchFn:e,listenerFn:t||function(){},valueEq:!!n,last:n?B.Core.newQuote(e(self)):e(self)};this._watchStack.push(r)},digest:function(){var e,t,self=this,n=[],i=[],o=10,r=function(e,t,n){return n?_.isEqual(e,t):e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},a=function(){var e=self._watchStack,t,i,o=!1;return _.each(e,function(e,a){var s=e.watchFn(self),c=e.last;e.valueEq&&(s=B.Core.newQuote(s,!0)),B.Core.isPlainObject(s)&&B.Core.isPlainObject(c)&&e.valueEq?(t=_.pick(s,B.Core.getObjectKeyList(s)),i=_.pick(c,B.Core.getObjectKeyList(c))):(t=s,i=c),r(t,i,e.valueEq)||(n.push(function(){return e.listenerFn(s,c,self)}),e.valueEq?e.last=B.Core.newQuote(s):e.last=s,o=!0)}),o};do e=a(),t=e&&!!o--;while(t);return _.each(n,function(e){e()}),this},callIns:function(e){var self=this,t="",n="",i=[],o="",r=$("[ba-ins]",e).not(".isTemplate [ba-ins],[template] [ba-ins]"),a=$("[ba-ins-get]",e).not(".isTemplate [ba-ins],[template] [ba-ins]"),s=function(e,t){var n;return _.each(t,function(e,i){e.search(/^@.+/g)!==-1&&(n=e.replace(/^@/g,""),t[i]=self._instruction.variable[n])}),i.unshift(e),o.search(/\./)===-1?t.unshift("ins."+o):t.unshift(o),t};_.isUndefined(self._instruction)&&(self._instruction={}),e||_.each(self._instruction,function(e,t){_.isEmpty(e.handler)||e.dom.off(e.event,e.handler),delete self._instruction[t]}),a.each(function(){var e=$(this),t=e.attr("ba-ins-get"),n,i;t=t.split(","),_.each(t,function(t){t=t.split(":"),2===t.length&&(n=t[0].replace(/^@/g,""),i="*"===t[1]?e.html():"val"===t[1]?e.val():e.attr(t[1]),_.isUndefined(self._instruction.variable)&&(self._instruction.variable={}),self._instruction.variable[n]=i)})}),r.each(function(e){var r=$(this),a=!1,c=Math.random(0,1);self._instruction[e+c]={dom:r},n=r.attr("ba-ins"),n=n.split(":"),o=n.shift(),i=n,t=o.split("~"),2===t.length?(o=t[1],t=t[0],i=s(r,i),function(){var n=i,o=function(){self.use.apply(self,n)};self._instruction[e+c].handler=o,r.on(t,o)}()):(t=null,i=s(r,i),self.use.apply(self,i)),self._instruction[e+c].ins=n,self._instruction[e+c].call=o,self._instruction[e+c].arg=i,self._instruction[e+c].event=t,self._instruction[e+c].dom=r})},confDev:window.devMode,confUseNoSuffixImg:!1,confProRootUrl:"index.htm"/*tpa=http://www.beibei.com/*/,confDevRootUrl:"http://dev.beibei.com/",confProImgUrl:"http://www.beibei.com/upload/",confDevImgUrl:"http://dev.beibei.com/upload/",confProGetTimeUrl:"http://d.beibei.com/ts.json",confDevGetTimeUrl:"http://d.beibei.com/ts.json",confMsg:{netError:"网络繁忙，请稍后重试",apiError:"网络繁忙，请稍后重试",apiCode404:"请求未找到，请联系客服或稍后重试",apiCode500:"请求发生错误，请联系客服或稍后重试"},"package":{loaded:{}},store:{timeDifference:0,serviceTime:0},ins:{reloadPage:function(){window.location.reload()}},renderView:function(e,t){var self=this,n=function(e,t){var i=e.find("[op-value]").add(e.filter("[op-value]"));i.each(function(){var e=$(this),n=e.attr("op-value");if(_.isUndefined(e.attr("op-attr")))e.html(B.Core.getObject(t,n));else{var i=e.attr("op-attr").split(",");n=n.split(","),_.each(i,function(i,o){if("*"===i)return void e.html(B.Core.getObject(t,n[o]));if("value"===i&&e.is("input"))e.val(B.Core.getObject(t,n[o]));else{var r=B.Core.getObject(t,n[o]);_.isBoolean(r)?r===!0&&e.prop(i,i):e.attr(i,r)}})}}),i.find("[op-select]").each(function(){var e=$(this),n=e.attr("op-select"),i=B.Core.getObject(t,n);e.find('option[value="'+i+'"]').attr("selected","selected")}),e.find("[op-each]").add(e.filter("[op-each]")).each(function(){var e=$(this),i=B.Core.getObject(t,e.attr("op-each")),o=e.attr("op-each-item");e.html(""),(_.isArray(i)||_.isObject(i))&&_.each(i,function(t,i){var r=self.getTemplate(o);e.append(r),n(r,t)})})};n(e,t)},getTemplate:function(e){var t=null;return t=_.isUndefined(this["template"+e.firstUpperCase()])?$('[template="'+e+'"]').clone():this["template"+e.firstUpperCase()].clone(),t.attr("template-display")?t.css("display",t.attr("template-display")):t.show(),t.attr("template")&&t.removeAttr("template"),t.attr("template-display")&&t.removeAttr("template-display"),t},useView:function(){return this.renderView}.mix(),fn:{analyzeErrorMessage:function(e){var self=this,t="";return _.isString(e)?t=e:(_.each(e,function(e,n){t+=e+"<br/>"}),t=t.replace(/<br\/>$/g,"")),t},deRound:function(e,t){var n;return t=Number(t),n=Math.pow(10,_.isNaN(t)?4:t+2),Math.round(e*n)/n},getFormatPrice:function(e){e=_.isUndefined(e)?0:this.fn.deRound(e);var t=e%100;return e/=100,0===t?e+=".00":t%10===0&&(e+="0"),String(e)},getFormatTimeleft:function(e){return e>31536e6?Math.ceil(e/31536e6)+"年":e>864e5?Math.ceil(e/864e5)+"天":e>36e5?Math.ceil(e/36e5)+"小时":e>6e4?Math.ceil(e/6e4)+"分钟":e>0?Math.ceil(e)+"秒":void 0},getFormatDiscount:function(e,t){var n=e/t;return!(n>=1)&&(n<=.1?1:Math.floor(100*n)/10)},getUrlParam:function(){var e=window.location.search,t=function(e){for(var t={},n=e.substr(1).split("&"),i=n.length,o=[];i--;)o=n[i].split("="),t[o[0]]=o[1];return t},n=e.indexOf("?")!==-1?t(e):{},i,o;switch(arguments.length){case 0:break;case 1:if(i=arguments[0],_.isString(i))return n[i];if(_.isFunction(i))return o=i,o(n),n;break;case 2:if(i=arguments[0],o=arguments[1],_.isString(i)&&_.isFunction(o))return o(n[i]),n[i]}return n},getServerTime:function(e){var self=this;$.ajax({url:window.devMode?self.confDevGetTimeUrl:self.confProGetTimeUrl,type:"GET",dataType:"jsonp",crossDomain:!0}).done(function(t){e(1e3*t.ts)})},specifiedDateFn:function(e,t,n,i){var o=(new Date).getTime();e=null!==e&&moment(e)._d.getTime(),t=null!==t&&moment(t)._d.getTime(),e!==!1&&t!==!1&&o>=e&&o<t||e!==!1&&t===!1&&o>=e||e===!1&&t!==!1&&o<t||e===!1&&t===!1?n.apply(this):i.apply(this)}}}),B.Widget=B.Object.extend({init:function(){var self=this;if(self._super(),self.templateMain&&1===self.templateMain.length){self.templateMain=self.templateMain.clone();for(var e in self)if(0===e.search(/view\w+/g)){var t=self[e];self[e]=self.templateMain.find('[wg-view="'+t+'"]'),0===self[e].length&&(self[e]=self.templateMain.filter('[wg-view="'+t+'"]'))}}self.onEvent(),self.onWatch()},conf:{},stName:"",stId:"",onWatch:function(){},onEvent:function(){},api:{},view:{},fn:{}}),B.Widget.reopenClass({create:function(e){e=e||{};var self=this,t=self._super({conf:e,stId:self.prototype.stName+String(_.random(1e8,99e7))+(new Date).getTime()});return t}}),B.widgetMessageNotification=B.Widget.extend({init:function(){var self=this;self._super(),self.use("view.renderMessageBox")},conf:{type:"info",closeTime:5e3,iconType:"default",apparent:!1,maxMessageNum:4},stName:"widgetMessageNotification",stMessageNum:0,methodSend:function(e,t){var self=this,n;t=t||{},t=$.extend(!0,{},self.conf,t);var i={danger:"Danger",success:"Success",warning:"Warning",info:"Primary"},o=self["templateMessage"+i[t.type]].clone();if(self.renderView(o,{msg:e}),self.use("view.renderMessageItem",o,t),self.viewMessageBox.append(o),n="border-box"===o.css("box-sizing")?o.outerHeight():o.height(),setTimeout(function(){o.css({transform:"rotateX(0deg) translateZ(45px) scale(1)",height:n})}),self.stMessageNum=self.viewMessageBox.children('[wg-view^="message"]').length,self.stMessageNum>t.maxMessageNum)for(var r=0;r<self.stMessageNum-t.maxMessageNum;r++)self.use("view.delMessage",r);return t.closeTime>0&&setTimeout(function(){self.use("view.delMessage",o)},t.closeTime),this},templateMain:$('<div wg-view="messageBox"></div>'),templateMessagePrimary:$('<div wg-view="messagePrimary"><span op-value="msg"></span><span wg-view="messageClose"><i class="iconfont">&#xf00b3;</i></span></div>'),templateMessageWarning:$('<div wg-view="messageWarning"><span op-value="msg"></span><span wg-view="messageClose"><i class="iconfont">&#xf00b3;</i></span></div>'),templateMessageDanger:$('<div wg-view="messageDanger"><span op-value="msg"></span><span wg-view="messageClose"><i class="iconfont">&#xf00b3;</i></span></div>'),templateMessageSuccess:$('<div wg-view="messageSuccess"><span op-value="msg"></span><span wg-view="messageClose"><i class="iconfont">&#xf00b3;</i></span></div>'),viewMessageBox:"messageBox",onWatch:function(){},onEvent:function(){var self=this;self._super(),self.viewMessageBox.on("mouseover",'[wg-view^="message"]',function(){$(this).find('[wg-view="messageClose"]').css({right:"0"})}).on("mouseout",'[wg-view^="message"]',function(){$(this).find('[wg-view="messageClose"]').css({right:"-24px"})}).on("click",'[wg-view="messageClose"]',function(){var e=self.viewMessageBox.children('[wg-view^="message"]').index($(this).parent()),t=self.viewMessageBox.children('[wg-view^="message"]:eq('+e+")");self.use("view.delMessage",t)})},api:{},view:{renderMessageBox:function(){var self=this;$("body").append(self.viewMessageBox),self.viewMessageBox.css({position:"fixed",top:"0",left:"50%",width:"400px","margin-left":"-200px",padding:"6px 10px","z-index":"9999",opacity:"http://st.beibei.com/static/build/js/8ac592096em/0.97"})},renderMessageItem:function(e,t){var self=this,n=t.type,i="#428bca";if("info"===n?i="#428bca":"danger"===n?i="#d9534f":"warning"===n?i="#f0ad4e":"success"===n&&(i="#5cb85c"),e.css({margin:"4px 0",color:"#fff",padding:"6px 28px 6px 10px","border-radius":"4px","line-height":"http://st.beibei.com/static/build/js/8ac592096em/1.3em","font-size":"13px",position:"relative",transform:"rotateX(-90deg) translateZ(20px) scale(1)",transition:"http://st.beibei.com/static/build/js/8ac592096em/0.6s",overflow:"hidden",background:i}),e.find("p").css({"margin-bottom":"0"}),e.find('[wg-view="messageClose"]').css({position:"absolute",display:"block",right:"-24px",top:"0",width:"24px",height:"100%",cursor:"pointer",transition:"http://st.beibei.com/static/build/js/8ac592096em/right 0.15s",background:"rgba(255, 255, 255, 0.2)",filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr=#ffffff20,endColorstr=#ffffff20)"}),e.find('[wg-view="messageClose"] i').css({"font-size":"12px",position:"absolute",top:"50%","margin-top":"-8px",left:"50%","margin-left":"-6px"}),t.iconType!==!1){var o=$('<i class="iconfont"></i>');"default"===t.iconType?"success"===n?o.html("&#xf0156;"):"danger"===n?o.html("&#xf0155;"):"warning"===n?o.html("&#xf0153;"):"info"===n&&o.html("&#xf0142;"):o.html(t.iconType),e.find("span:first").prepend(o),e.find(o).append(" ")}t.apparent&&(self.viewMessageBox.find(".isApparent").fadeOut(500,function(){$(this).remove()}),e.addClass("isApparent"),e.css({width:"400px",position:"fixed",top:"50%",padding:"12px 28px 12px 10px","margin-top":"-50px",left:"50%","margin-left":"-200px","text-align":"center","font-size":"18px"}),e.find("span i.iconfont").css({"font-size":"18px"}),e.find('[wg-view="messageClose"] i.iconfont').css({"margin-top":"-11px","font-size":"12px"}))},delMessage:function(e){var self=this,t;t=_.isNumber(e)?self.viewMessageBox.children('[wg-view^="message"]:not(.isApparent):eq('+e+")"):e,t.css({height:"0",padding:"0 28px 0 10px",opacity:"0",transition:"http://st.beibei.com/static/build/js/8ac592096em/0.4s"}),setTimeout(function(){t.remove()},400)}},fn:{}}),B.Page=B.Object.extend({init:function(){var self=this;self._super(),$.cookie.defaults={path:"/",domain:"http://st.beibei.com/static/build/js/8ac592096em/beibei.com"},self.queryView(),self.queryTemplate(),self.onEvent(),self.onWatch(),self.use("fn.environmentTip"),_.each(self.widget,function(e,t){_.isUndefined(B["widget"+t.firstUpperCase()])&&(self["widget"+t.firstUpperCase()]=B["widget"+e.use.firstUpperCase()].create(e.conf))}),B.Core.positionFooter(),self.use("fn.initLoginStatus"),self.use("fn.autoLogin"),self.holdImgLazyLoad||self.use("fn.setImgLazyLoad")},viewActionBackLink:$(".action-back,.view-ActionBack"),viewLoginStatus:null,pageData:{},pageId:null,store:{},holdImgLazyLoad:!1,widget:{publicMessageNotification:{use:"messageNotification",conf:{}}},onWatch:function(){},onEvent:function(){var self=this;$(window).on("resize",B.Core.positionFooter),$(document).on("mousedown",self.viewActionBackLink.selector,function(){var e=$(this),t=window.location.href;if(t.indexOf("member/")===-1){var n=e.attr("href");n.indexOf("done=")===-1&&(n+=n.indexOf("?")===-1?"?done=":"&done=",e.attr("href",n+encodeURIComponent(t)))}}),$(document).on("mouseover",".dropdown, .nav-cart",function(){$(this).addClass("hover")}).on("mouseout",".dropdown, .nav-cart",function(){$(this).removeClass("hover")})},api:{},view:{},fn:{setImgLazyLoad:function(e){e=e||$("http://st.beibei.com/static/build/js/8ac592096em/img.lazy"),e.lazyload({threshold:200,data_attribute:"src",failure_limit:5})},initLoginStatus:function(){var self=this,e=self.viewLoginStatus.attr("data-status"),t=$.cookie("_m_gd_")||1,n=B.H.lastLoginId();"0"===e&&B.H.isLogin()===!0&&null!==n&&(self.viewLoginStatus.html('<a class="lv-icon lv'+t+'" c-bname="通顶菜单-用户等级图标" clog c-emit="click" c-et="event" c-etl="" href="http://st.beibei.com/static/build/js/8ac592096em/'+(self.confDev?"http://i-dev.beibei.com/member/grade.html":"http://i.beibei.com/member/grade.html")+'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a><a class="striking-link" c-bname="通顶菜单-用户名" clog c-emit="click" c-et="event" c-etl="" href="http://st.beibei.com/static/build/js/8ac592096em/'+(self.confDev?"http://i-dev.beibei.com/":"http://i.beibei.com/")+'">'+n+'</a> &nbsp; <a c-bname="通顶菜单-退出" clog c-emit="click" c-et="event" c-etl="" href="http://st.beibei.com/static/build/js/8ac592096em/'+(window.devMode?"http://dev.beibei.com/member/logout.html":"http://www.beibei.com/member/login.html")+'" rel="nofollow">[退出]</a>'),self.viewLoginStatus.after('<li class="seg"></li><li><a c-bname="通顶菜单-消息" clog c-emit="click" c-et="event" c-etl="" href="http://st.beibei.com/static/build/js/8ac592096em/'+(window.devMode?"http://i-dev.beibei.com/message/index.html":"http://i.beibei.com/message/index.html")+'">消息</a><li class="seg"></li><li><a c-bname="通顶菜单-我的订单" clog c-emit="click" c-et="event" c-etl="" href="http://st.beibei.com/static/build/js/8ac592096em/'+(window.devMode?"http://i-dev.beibei.com/trade/order/lists.html":"http://i.beibei.com/trade/order/lists.html")+'">我的订单</a></li><li class="seg"></li><li><a c-bname="通顶菜单-我的贝贝" clog c-emit="click" c-et="event" c-etl="" href="http://st.beibei.com/static/build/js/8ac592096em/'+(window.devMode?"http://i-dev.beibei.com/":"http://i.beibei.com/")+'">我的贝贝</a></li>'))},autoLogin:function(){var self=this,e=window.document.cookie,t=0,n,i={login:function(){$.ajax({url:self.confDev?"http://dev.beibei.com/member/boot":"http://d.beibei.com/member/boot",type:"GET",dataType:"jsonp"}).done(function(){self.use("fn.initLoginStatus")})}};t=$.cookie("_remember_me_"),n=$.cookie("st_au"),"1"===t&&null===n&&i.login()},environmentTip:function(){if(window.devMode&&window.showEnvironmentLogo){$(document).on("mouseover","#environmentTip",function(e){e.preventDefault();var t=$(this),n=t.offset().left;0===n?t.css("left","auto").css("right",0):t.css("right","auto").css("left",0)});var e='<img id="environmentTip" src="evn.png"/*tpa=http://b0.hucdn.com/img/admin/evn.png*/ width="154" height="50" style="position: fixed;top: 0;z-index: 110;" />';$("body").append(e)}}},useApi:function(e,t,n){var self=this,i={},o=$.extend(!0,{noHxcsrf:!1,devUrl:null,proUrl:null,type:"POST",dataType:"json",async:!0,done:function(){},fail:function(){},always:function(){}},self.api[e]),r=!1;$.extend(i,{done:function(){},fail:function(){},always:function(){}},n),o.noHxcsrf===!1&&(t=$.extend(!0,{hxcsrf:g.__t__},t)),o.url=self.confDev?o.devUrl:o.proUrl,o.data=t,o.statusCode={500:function(){r||(self.widgetPublicMessageNotification.methodSend(self.use("fn.analyzeErrorMessage",self.confMsg.apiCode500||self.confMsg.netError),{type:"danger"}),r=!0)},404:function(){r||(self.widgetPublicMessageNotification.methodSend(self.use("fn.analyzeErrorMessage",self.confMsg.apiCode404||self.confMsg.netError),{type:"danger"}),r=!0)}},$.ajax(o).done(function(){o.done.apply(self,arguments),i.done.apply(self,arguments),self.catchAjaxError.apply(self,arguments)}).fail(function(e){o.fail.apply(self,arguments),i.fail.apply(self,arguments),r||(500===e.status?self.widgetPublicMessageNotification.methodSend(self.use("fn.analyzeErrorMessage",self.confMsg.apiCode500||self.confMsg.netError),{type:"danger"}):404===e.status?self.widgetPublicMessageNotification.methodSend(self.use("fn.analyzeErrorMessage",self.confMsg.apiCode404||self.confMsg.netError),{type:"danger"}):self.widgetPublicMessageNotification.methodSend(self.use("fn.analyzeErrorMessage",self.confMsg.apiFail||self.confMsg.netError),{type:"danger"}),r=!0)}).always(function(e){o.always.apply(self,arguments),i.always.apply(self,arguments),302===Number(e.success)?window.location.href=e.url||(self.confDev?self.confDevRootUrl:self.confProRootUrl):500===Number(e.success)&&e.ignore!==!0&&self.widgetPublicMessageNotification.methodSend(self.use("fn.analyzeErrorMessage",e.message||self.confMsg.netError),{type:"danger"})})},catchAjaxError:function(e){var self=this;e.success===!1&&302!==Number(e.success)&&500!==Number(e.success)&&e.ignore!==!0&&self.widgetPublicMessageNotification.methodSend(self.use("fn.analyzeErrorMessage",e.message||self.confMsg.netError),{type:"danger"})},queryView:function(e){!_.isUndefined(e)&&_.isArray(e)&&0!==e.length||(e=!1);var self=this,t=self._viewQueryCache,n,i,o=function(e){return e&&e.selector?e.selector:""};if(_.isUndefined(t)){t={};for(var r in self)0===r.search(/view\w+/g)&&(i=r.replace(/^view/,""),n=_.isString(self[r])?self[r]:_.isNull(self[r])?".view-"+i:o(self[r]),!(_.isString(self[r])||_.isNull(self[r])||_.isUndefined(self[r]))&&self[r].length>0||(t[i]=n,self[r]=$(n+":not(.isTemplate "+n+")")))}else if(e!==!1){var a;_.each(e,function(e,n){i=e.replace(/^view/,""),a=t[i],a&&(self["view"+i]=$(a+":not(.isTemplate "+a+")"))})}else _.each(t,function(e,t){self["view"+t]=$(e+":not(.isTemplate "+e+")")});self._viewQueryCache=t},queryTemplate:function(){var self=this;$("[template]").each(function(){var e=$(this),t=e.attr("template");self["template"+t.firstUpperCase()]=e})},renderView:function(){var self=this,e=arguments[2];if(_.isUndefined(e))e=!0,self._super.apply(self,arguments);else{var t=_.initial(arguments);self._super.apply(self,t)}e===!0?self.queryView():_.isArray(e)&&self.queryView(e)}}),B.Page.reopenClass({create:function(e){return this._super(e,function(e){window.Page=e}),window.Page}}),B.initPage=function(){if(window.originPageId=window.pageId,!_.isUndefined(pageData)&&!_.isUndefined(pageId)){var e=pageId,t=!1,n;for(e=e.replace(/\_/g,""),e=e.replace(/\.\w+$/g,""),e=e.split("/"),e=_.map(e,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}),pageId=n="page"+e.join("");!t&&"page"!==n;)_.isUndefined(B[n])?n=n.replace(/[A-Z][a-z0-9]*?$/g,""):t=!0;"page"===n&&(n="Page");try{B[n].reopen({pageData:pageData,pageId:pageId})}catch(i){if(window.devMode)throw i}}},$(function(){B.initPage()}),window.bbclick=function(e){var t=$.cookie("bblog-debug")||!1;e=$.extend({url:window.devMode?"p1.gif"/*tpa=http://c1-dev.hucdn.com/p1.gif*/:"p1-1.gif"/*tpa=http://c1.hucdn.com/p1.gif*/},e);var n=[],i={},o=window.location.href,r=window.browser.name,a=window.browser.version,s=window.browser.alias||"";$.cookie("st_au")||$.cookie("tem-au")||$.cookie("tem-au","ul"+(String(+new Date).slice(-6)+_.random(1e8,9e8)));var c={markPre:function(e,t){var n=window.location.href.replace(/^(.+?)\#(.+)$/g,"$1");$.cookie("pre-rid",e),$.cookie("pre-sid",t),$.cookie("pre-url",n)},getPre:function(){window.document.referrer===$.cookie("pre-url")&&(i.rid=$.cookie("pre-rid"),i.sid=$.cookie("pre-sid")),$.removeCookie("pre-url")},getLog:function(e){e&&(e=[].concat(e));var t=[];_.each(e,function(e){t.push('[c-rid="'+e+'"]')});var n=$("body");t.length>0&&(n=$(t.join(","))),n.find("[clog]:visible").not("[clog-get]").each(function(){var e=$(this),t=e.attr("c-emit");t&&(t=t.split(";"),_.each(t,function(t){var n={rid:e.closest("[c-rid]").attr("c-rid")||0,entity_type:e.attr("c-et")||"null",entity_list:e.attr("c-etl").split(";")||[]},i={block_name:e.attr("c-bname")};if(void 0!==e.attr("c-pos")&&(i={block_name:e.attr("c-bname"),position:e.attr("c-pos")}),t=$.trim(t),/^show/.test(t))n.et=t.split(":")[1]||"show",c.addLog(n,i);else if(/^click/.test(t)){var o;/click\[.+?\]/.test(t)&&(o=t.replace(/^.*\[(.+?)\].*$/g,"$1")),e.on("click",o?o:"",function(){var e=0;$.cookie("_logged_")&&(e=$.cookie("_logged_").split("").pop()),c.markPre(n.rid,e),n.et=t.split(":")[1]||"click",c.addLog(n,i),c.sendLog()})}}),e.attr("clog-get",!0))})},sendLog:function(){var o={};_.each(n,function(e){var t=e.rid+"/"+e.et+"/"+e.entity_type;o[t]?o[t].entity_list?o[t].entity_list=o[t].entity_list.concat(e.entity_list):o[t].entity_list=e.entity_list:o[t]=e}),_.each(o,function(n){if(n.entity_list&&n.entity_list.length){n.entity_list=n.entity_list.join(";");try{t&&console.log("send log",n)}catch(o){}i.rid&&i.sid&&(n.prid=i.rid,n.psid=i.sid),$.ajax({url:e.url,dataType:"jsonp",type:"GET",cache:!0,jsonpCallback:"c",data:n})}}),n=[]},addLog:function(e,t){var self=this,i=self.toolLog(),c=$.extend(!0,{source:"PC",url:i.url,url_pattern:i.url_pattern,pre_url:i.pre_url,preurl_pattern:i.preurl_pattern},t);e=$.extend(!0,{hxid:$.cookie("hxid")||$.cookie("JSESSIONID"),et:"null",rid:0,sid:0,xid:$.cookie("st_au")||$.cookie("tem-au"),entity_type:"null",entity_list:[],browser_url:o,browser_name:r,browser_version:a,browser_alias:s,json:JSON.stringify(c)},e),$.cookie("_logged_")&&(e.sid=$.cookie("_logged_").split("").pop()),n.push(e)},toolLog:function(){var e=window.location,t=e.href,n="",i="",o="",r=function(e){return e.split(/\/search\/item/).length>1?e.split(/\/search\/item/)[0]+"/search/item":e.split(".html").length>1?e.split(/\d{3}/).length>1?e.split(/\d{3}/)[0]:e.split(".html")[0]+".html":e.split(/com\W{2}/).length>1?e.split(/com\W{2}/)[0]+"com":e};return n=r(t),i=document.referrer||"",o=i?r(i)||"":"",{url:t,url_pattern:n,pre_url:i,preurl_pattern:o}},initLog:function(){var self=this,t=self.toolLog(),n={source:"PC",url:t.url,url_pattern:t.url_pattern,pre_url:t.pre_url,preurl_pattern:t.preurl_pattern};$.ajax({url:e.url,dataType:"jsonp",type:"GET",cache:!0,jsonpCallback:"c",data:{hxid:$.cookie("hxid")||$.cookie("JSESSIONID"),et:"pageshow",xid:$.cookie("st_au")||$.cookie("tem-au"),browser_url:o,browser_name:r,browser_version:a,browser_alias:s,json:JSON.stringify(n)}})}};return c.initLog(),c.getPre(),c.getLog(),c.sendLog(),{add:function(e,t){return c.addLog(e,t),this},get:function(e){return c.getLog(e),this},pre:function(){return i},list:function(){return n},send:function(){return c.sendLog(),this}}},window.bb=window.bbclick(),B.widgetCartBox=B.Widget.extend({init:function(){var self=this;self.conf.container=$(self.conf.container),self.conf.trigger=$(self.conf.trigger),self._super(),"trigger"===self.conf.mode&&(self.conf.trigger.css({position:"relative"}),self.conf.container.css({position:"absolute",top:self.conf.triggerPosition[0],right:self.conf.triggerPosition[1],bottom:self.conf.triggerPosition[2],left:self.conf.triggerPosition[3]}),self.conf.container.hide()),self.use("view.renderMain"),null===$.cookie("cart_c")?self.use("api.getCartInfo"):setTimeout(function(){self.stCartNumFromCookie=+$.cookie("cart_c"),self.digest().digest()},500)},conf:{mode:"normal",container:null,trigger:null,triggerEvent:"hover",triggerPosition:[0,0,0,0],maxItemNum:5,direction:"top",needTitle:!0,hoverGetData:!1,settleBtnLink:window.devMode?"http://trade-dev.beibei.com/cart/mine":"http://trade.beibei.com/cart/mine",settleBtnText:'<i class="iconfont">&#xf0179;</i>去购物车结算',showMoreBtnLink:window.devMode?"http://trade-dev.beibei.com/cart/mine":"http://trade.beibei.com/cart/mine",showMoreBtnText:"查看全部",shoppingUrl:window.devMode?"index.htm":"index.htm"/*tpa=http://www.beibei.com/*/,cbAfterGetData:function(){}},stName:"widgetCartBox",stCartInfo:null,stCartNumFromCookie:0,stCartItemNum:function(){return _.size(this.stCartInfo)||this.stCartNumFromCookie}.mix("=stCartInfo","stCartNumFromCookie"),stCartItemPrice:function(){var e=0;return _.each(this.stCartInfo,function(t){e+=t.price*t.num}),e}.mix("=stCartInfo"),stMouseoverGetCartInfo:!1,methodUpdate:function(){this.use("api.getCartInfo",!0)},templateMain:$('<div wg-view="main"><div wg-view="title" op-value="title"></div><ul wg-view="list" op-each="cartInfo" op-each-item="ListItem"></ul><div wg-view="footer"><div wg-view="footerTotal">小计：<span wg-view="footerTotalNum" op-value="totalPrice"></span></div><div wg-view="footerBtnBar"><a href="javascript:;" wg-view="footerSettleBtn" op-value="settleBtnText,settleBtnLink" op-attr="*,href"></a></div></div><div wg-view="footerBg"></div></div>'),templateListItem:$('<li wg-view="item"><a href="#" wg-view="imglink" op-value="itemLink" op-attr="href"><img wg-view="img" op-value="imgUrl" op-attr="src" /></a><a href="#" wg-view="name" op-value="title,itemLink" op-attr="*,href"></a><p wg-view="sku" op-value="sku_props"></p><p wg-view="price" op-value="price"></p></li>'),templateListShowMoreBtn:$('<li><a href="javascript:;" class="cartBox-ListShowMoreBtn" op-value="showMoreBtnText,showMoreBtnLink" op-attr="*,href"></a></li>'),viewMain:"main",viewTitle:"title",viewList:"list",viewFooter:"footer",viewFooterTotal:"footerTotal",viewFooterTotalPrice:"footerTotalPrice",viewFooterTotalNum:"footerTotalNum",viewFooterBtnBar:"footerBtnBar",viewFooterSettleBtn:"footerSettleBtn",viewFooterBg:"footerBg",onWatch:function(){var self=this;self._super(),self.watch("stCartInfo",function(){self.use("view.renderMain")},!0)},onEvent:function(){var self=this;self._super(),self.viewList.on("mouseover","li:not(.empty-cart,.loading-cart)",function(){$(this).css({background:"#f6f6f6"})}).on("mouseout","li:not(.empty-cart,.loading-cart)",function(){$(this).css({background:"#fff"})}),self.conf.hoverGetData!==!1&&$(self.conf.hoverGetData).on("mouseover",function(){null!==self.stCartInfo||self.stMouseoverGetCartInfo||(self.stMouseoverGetCartInfo=!0,self.use("api.getCartInfo"))}),"trigger"===self.conf.mode&&"hover"===self.conf.triggerEvent?self.conf.trigger.on("mouseover",function(){null!==self.stCartInfo||self.stMouseoverGetCartInfo||(self.stMouseoverGetCartInfo=!0,self.use("api.getCartInfo")),self.conf.container.show()}).on("mouseout",function(){self.conf.container.hide()}):"trigger"===self.conf.mode&&"click"===self.conf.triggerEvent&&self.conf.trigger.on("click",function(){1===self.conf.container.filter(":hidden").length?(null===self.stCartInfo&&self.use("api.getCartInfo"),self.conf.container.show()):self.conf.container.hide()}),self.viewList.on("mouseenter",".empty-cart",function(){var e=self.viewList.find("http://st.beibei.com/static/build/js/8ac592096em/.empty-cart span.note"),t=self.viewList.find(".empty-cart span.shopping");document.all&&!document.addEventListener||(e.css({left:"100%"}),t.css({left:"0"}))}).on("mouseleave",".empty-cart",function(){var e=self.viewList.find("http://st.beibei.com/static/build/js/8ac592096em/.empty-cart span.note"),t=self.viewList.find(".empty-cart span.shopping");document.all&&!document.addEventListener||(e.css({left:"0"}),t.css({left:"100%"}))}),self.viewList.on("click",".empty-cart",function(){window.location.href=self.conf.shoppingUrl})},api:{getCartInfo:function(e){e=e||!1;var self=this;return B.H.isLogin()===!1?(self.set("stCartInfo",{}),void self.conf.cbAfterGetData()):void(e||_.isUndefined(Page.store.cartInfo)?$.ajax({url:Page.confDev?"http://trade-dev.beibei.com/cart/ajax_mine.html":"http://trade.beibei.com/cart/ajax_mine.html",type:"POST",dataType:"jsonp"}).done(function(e){if(e.success===!0){var t={};_.each(e.data.cart_vo_map,function(e){_.each(e,function(e,n){t[e.id]=e})}),Page.set("store.cartInfo",t),self.set("stCartInfo",t),self.digest(),self.conf.cbAfterGetData()}else Page.set("store.cartInfo",{}),self.set("stCartInfo",{}),self.digest()}):self.set("stCartInfo",Page.store.cartInfo))}},view:{renderMain:function(){var self=this,e=self.viewMain,t="none",n=self.conf.container.height(),i=self.conf.container.width();e.attr("widget-id",self.stId).attr("widget-name",self.stName).css({background:"transparent",border:"1px solid #FF5482",width:i,"text-align":"left",color:"#000","z-index":"29",cursor:"default",position:"relative"}),self.conf.container.html(e),self.conf.needTitle&&self.use("view.renderTitle"),self.use("view.renderList"),self.use("view.renderFooter")},renderTitle:function(){var self=this,e=self.viewTitle,t;t=self.stCartItemNum>0?'<i class="iconfont">&#xf0148;</i> 购物车中有<b>'+self.stCartItemNum+"件</b>商品":null===self.stCartInfo?'<i class="iconfont">&#xf0179;</i> 正在载入购物车...':'<i class="iconfont">&#xf0179;</i> 购物车是空的',e.css({padding:"2px 15px","border-bottom":"1px solid #e3e3e3",background:"#FFF9FB","font-size":"13px","text-align":"center",color:"#FF5482"}),self.renderView(e,{title:t}),e.find("b").css({color:"#e53363"})},renderList:function(){var self=this,e=self.viewList;if(e.css({background:"#fff","overflow-y":"hidden"}),_.size(self.stCartInfo)>0?self.use("view.renderListItem"):null===self.stCartInfo?self.use("view.renderListItemForLoading"):self.use("view.renderListItemForEmpty"),self.viewList.find("li:gt("+(self.conf.maxItemNum-1)+")").remove(),self.stCartItemNum>self.conf.maxItemNum){var t=self.getTemplate("ListShowMoreBtn");self.renderView(t,{showMoreBtnText:'<i class="iconfont">&#xf0161;</i> '+self.conf.showMoreBtnText,showMoreBtnLink:self.conf.showMoreBtnLink}),t.css({width:"100%",padding:"0","text-align":"center"}),t.find("a").css({width:"100%",padding:"0","text-align":"center",border:"0","font-weight":"normal","font-size":"14px",color:"#aaa",height:"37px","line-height":"37px",display:"block"}),self.viewList.append(t)}e.find("li:last").css({"border-bottom":"none"})},renderListItemForEmpty:function(){var self=this;self.viewList.html(""),self.use("fn.specifiedDateFn","2014-5-27","2014-6-3 23:59:59",function(){this.viewList.append('<li class="empty-cart"><span class="note">购物车还是空的</span><span class="shopping"><i class="iconfont">&#xf0178;</i> 去专场逛逛</span></li>')},function(){this.viewList.append('<li class="empty-cart"><span class="note">赶快去挑选商品吧！</span><span class="shopping"><i class="iconfont">&#xf0178;</i> 去专场逛逛</span></li>');
}),self.viewList.find(".empty-cart").css({"font-size":"16px",color:"#99918c",padding:"80px 0","text-align":"center",position:"relative",overflow:"hidden","list-style":"none",cursor:"pointer"}),self.viewList.find("http://st.beibei.com/static/build/js/8ac592096em/.empty-cart span.note").css({width:"100%",display:"block",transition:"http://st.beibei.com/static/build/js/8ac592096em/all 0.2s",position:"absolute",left:"0",top:"80px",margin:"0",padding:"0"}),self.viewList.find(".empty-cart span.shopping").css({width:"100%",display:"block",transition:"http://st.beibei.com/static/build/js/8ac592096em/all 0.2s",position:"absolute",left:"-100%",top:"80px"}),document.all&&!document.addEventListener&&(self.viewList.find("http://st.beibei.com/static/build/js/8ac592096em/.empty-cart span.note").css({left:"0px"}),self.viewList.find(".empty-cart span.shopping").remove())},renderListItemForLoading:function(){var self=this;self.viewList.html(""),self.viewList.append('<li class="loading-cart"><img src="loading.gif"/*tpa=http://b0.hucdn.com/img/common/loading.gif*/ /></li>'),self.viewList.find(".loading-cart").css({padding:"20px 0","text-align":"center",position:"relative",overflow:"hidden","list-style":"none",cursor:"default"}),document.all&&!document.addEventListener&&(self.viewList.find("http://st.beibei.com/static/build/js/8ac592096em/.empty-cart span.note").css({left:"0px"}),self.viewList.find(".empty-cart span.shopping").remove())},renderListItem:function(){var self=this,e=B.Core.newQuote(self.stCartInfo);_.each(e,function(e,t){e.sku_props=e.sku_props.replace(/\d+:\d+:/g,"").replace(/;/g," "),e.price="&yen;"+self.use("fn.getFormatPrice",e.price)+'<br/><span wg-view="num"> x'+e.num+"</span>",e.itemLink=window.devMode?"http://dev.beibei.com/detail/"+e.event_id+"-"+e.product_id+".html":"http://www.beibei.com/detail/"+e.event_id+"-"+e.product_id+".html",e.imgUrl=e.img+"!60x60.jpg"}),self.renderView(self.viewList,{cartInfo:e}),self.viewList.find("li").css({padding:"12px","list-style":"none",position:"relative","border-bottom":"1px dotted #bebab7",overflow:"hidden",height:"60px"}),self.viewList.find('[wg-view="img"]').css({border:"2px solid #ccc",background:"#fff",padding:"2px",width:"50px",height:"50px",position:"relative","z-index":"4"}),self.viewList.find('[wg-view="name"]').css({position:"absolute",left:"0px",top:"15px",padding:"0 10px 0 80px","line-height":"http://st.beibei.com/static/build/js/8ac592096em/1.2em",height:"30px",overflow:"hidden","font-size":"13px",margin:"0",width:"50%","z-index":"3"}),self.viewList.find('[wg-view="sku"]').css({position:"absolute",color:"#aaa",left:"0px",top:"52px",padding:"0 10px 0 80px","line-height":"http://st.beibei.com/static/build/js/8ac592096em/1.2em",height:"14px",overflow:"hidden","font-size":"12px",margin:"0",width:"50%"}),self.viewList.find('[wg-view="price"]').css({position:"absolute",color:"#FF5482",right:"15px",top:"25px",overflow:"hidden","font-size":"16px","padding-left":"80px",margin:"0",width:"30%","line-height":"1em","text-align":"right"}),self.viewList.find('[wg-view="num"]').css({display:"inline",color:"#888","font-size":"13px"})},renderFooter:function(){var self=this,e={};e.totalPrice="&yen;"+self.use("fn.getFormatPrice",self.stCartItemPrice),e.totalNum=self.stCartItemNum,e.settleBtnText=self.conf.settleBtnText,e.settleBtnLink=self.conf.settleBtnLink,self.renderView(self.viewFooter,e),self.viewFooter.css({height:"47px","border-top":"1px solid #e3e3e3",background:"#FFF9FB"}),self.viewFooterTotal.css({"font-size":"13px",color:"#666",padding:"10px 15px",position:"absolute"}),self.viewFooterTotalPrice.css({color:"#e53363"}),self.viewFooterTotalNum.css({color:"#e53363","font-size":"18px"}),self.viewFooterSettleBtn.css({background:"#ff5482",padding:"4px 12px","font-size":"13px",color:"#fff","border-radius":"4px",border:"1px solid #ff3c70","border-bottom":"2px solid #e53363","float":"right","margin-right":"15px","margin-top":"6px",height:"24px",width:"auto","line-height":"24px"})},renderFooterBg:function(){for(var self=this,e="",t=0;t<40;t++)e+='<i class="iconfont">&#xf01a6;</i>';self.viewFooterBg.css({height:"16px",overflow:"hidden",position:"absolute",bottom:"-8px",left:"0",width:"100%","white-space":"nowrap"}),self.viewFooterBg.html(e).find("i").css({display:"inline-block","font-size":"18px","letter-spacing":"-4px","margin-top":"-2px",color:"#FFF9FB"}),self.viewFooterBg.find("i:first").css({"margin-left":"-9px"})}},fn:{}}),function(e,t){t.custom=t.custom||{};var n=window.location.protocol+"//www.",i=function(e){return n+"beibei.com/resource/v2-"+e.join("_")+".html"},o={isGettingRequest:!1,requestList:[]},r=function(e,t){o.isGettingRequest=!0,$.ajax({url:i(e),type:"GET",dataType:"jsonp",jsonpCallback:"amsGetFn",cache:!0}).done(function(e){var t={};e.success&&(_.each(e.data,function(e){try{var n=JSON.parse(e);t[n.rid]=t[n.rid]||{},t[n.rid][n._id]=n}catch(i){}}),_.each(t,function(e,t){l(t,e)})),window.bb.send()}).always(function(n){_.each(e,function(e){var t=$('[ams][rid="'+e+'"]').not("[ams-done]"),n=t.closest("li");t.remove()}),t&&t(n),o.isGettingRequest=!1,a(o.requestList,o.isGettingRequest)})},a=function(e,t){var n=null;e&&e.length>0&&!t&&(n=e.shift(),r(n.rids,n.callback))},s=function(e,t){var n=e?[].concat(e):[],i={};n.length&&(o.requestList.push({rids:n,callback:t}),a(o.requestList,o.isGettingRequest))},c=function(e){var t=!0,n=+new Date(e.showtime.start),i=+new Date(e.showtime.end),o=+new Date;return o<n||o>i||e.use===!1?null:e},l=function(e,t){var n=$('[ams][rid="'+e+'"]');if(0!==n.length){if(0===_.size(t))return void n.remove();var i=null;if(_.each(t,function(e){var t=c(e);t&&(i=t)}),null===i)return void n.remove();var o=!1;try{i.img=JSON.parse(i.img)}catch(r){}var a=i;if(a.img&&_.isArray(a.img)&&0!==a.img.length||""===a.text)if(!_.isEmpty(a.bg)&&!_.isEmpty(a.img)&&_.isArray(a.img)&&a.img.length>0){a.bg.color&&n.css("background-color",a.bg.color);try{a.bg.img=JSON.parse(a.bg.img)}catch(r){}_.isArray(a.bg.img)&&a.bg.img.length>0&&(n.css("background-image",a.bg.img[0]),n.css("background-repeat","repeat")),n.find("img").attr("src",a.img[0]).removeAttr("width height"),o=!0}else!_.isEmpty(a.img)&&_.isArray(a.img)&&a.img.length>0&&(n.find("img").attr("src",a.img[0]).removeAttr("width height"),o=!0);else n.html(a.text),o=!0;if(!o)return void n.remove();a.link&&"url"http://st.beibei.com/static/build/js/8ac592096em/===a.link.type&&a.link.url?n.attr("href",a.link.url).attr("target","_blank"):n.attr("href","javascript:;").attr("target","_self"),a.title&&n.attr("title",a.title),setTimeout(function(){n.find("img").css("zoom",1)}),+a.setTimeClose>0&&setTimeout(function(){n.slideUp(320,function(){n.remove()})},+a.setTimeClose),n.attr("ams-done",!0).show(),n.attr("data-style")&&n.attr("style",n.attr("style")+";"+n.attr("data-style"));var s=n.attr("c-bname")||"";$(document).on("click",n.selector,function(){window.bb.add({hxid:$.cookie("hxid")||$.cookie("JSESSIONID"),et:"click",rid:l,xid:$.cookie("st_au")||$.cookie("tem-au"),entity_type:"null",entity_list:[a._id]},{block_name:s}).send()});var l="91";+e<10?l+="00":+e<100&&(l+="0"),l+=e,window.bb.add({hxid:$.cookie("hxid")||$.cookie("JSESSIONID"),et:"show",rid:l,xid:$.cookie("st_au")||$.cookie("tem-au"),entity_type:"ams",entity_list:[a._id]})}};t.custom.amsControl=s;var u=e.pageData.amsRid;return u&&$.isArray(u)?(s(u),s):s}(window,window.X||(window.X={})),function(e,t,n){n.custom=n.custom||{},/seller(-dev)?\.beibei.com|hx(-dev)?\.beibei.com/gi.test(e.location.href)||(n.custom.ispAd=function(){var n=["iframe"],i=["http://st.beibei.com/static/build/js/8ac592096em/jiathis.com","http://st.beibei.com/static/build/js/8ac592096em/beibei.com","http://st.beibei.com/static/build/js/8ac592096em/live800.com","http://st.beibei.com/static/build/js/8ac592096em/kuaidi100.com","http://st.beibei.com/static/build/js/8ac592096em/open.qzone.qq.com","http://st.beibei.com/static/build/js/8ac592096em/mediav.com","http://st.beibei.com/static/build/js/8ac592096em/sogou.com"],o=null,r=null,a=30,s=500,c=["http"];o=new RegExp("^("+c.join("|")+")://[\\w-\\.]*?("+i.join("|")+")"),r=o;var l=function(e){return r.test(e)},u=function(t){return""===t||t===e.location.href},d=function(e){return 0===e.search("http://")},p=function(e){var n=t(e).attr("id");return!!n&&0===n.search("ads")},f=function(e){var t=e.src;return u(t)&&p(e)||d(t)&&!l(t)},h=function(e,n){t.ajax({url:"http://b.husor.cn/click.html?log=framekiller&src="+encodeURIComponent(e)+"|pc|"+encodeURIComponent(n),dataType:"jsonp"})},g=function(e){for(var n=t(e),i=e.parentNode;i&&i!==document.body;)p(i)&&(t(i).remove(),h(e.src,location.href),e=null),i=i.parentNode;e&&f(e)&&(n.remove(),h(e.src,location.href))},m=function(){t(n.join(",")).each(function(e,t){g(t)})},v=function(){Object.defineProperty&&e.BCMain&&Object.defineProperty(e,"BCMain",{value:function(){},configurable:!1}),Object.defineProperties&&e.BCMain&&Object.defineProperties(e.BCMain,{_js:{value:"127.0.0.1",configurable:!1},_redirect:{value:"127.0.0.1",configurable:!1},_ads:{value:"127.0.0.1",configurable:!1},_cms:{value:"127.0.0.1",configurable:!1},_third_req:{value:"127.0.0.1",configurable:!1},show:{value:function(){},configurable:!1},third_req:{value:function(){},configurable:!1},ready:{value:function(){},configurable:!1}}),"undefined"!=typeof Object.freeze&&e.BCMain?Object.freeze(e.BCMain):e.BCMain=null},w=e.MutationObserver||e.WebKitMutationObserver||e.MozMutationObserver,b=!!w;if(b){var _=function(e){t.each(e,function(e,i){t.each(i.addedNodes,function(e,i){t.each(n,function(e,t){i.tagName===t.toUpperCase()&&g(i)});var o=t(i),r=o.length?o.find(n.join(",")):null;r&&r.length&&r.each(function(){g(this)})})})},x=new w(_);x.observe(document.body,{childList:!0,subtree:!0}),setTimeout(function(){x.disconnect()},a*s)}else{var y=function(){a--&&(m(),setTimeout(y,s))};setTimeout(y,s)}m(),v()},t(function(){n.custom.ispAd()}))}(window,$,window.X||(window.X={})),function(){var e="",t="",n={},i=!1,o=!1;if($(".J_mBnCat").length){n={getInfo:function(){$.ajax({url:"//sapi"+(window.devMode?"-dev":"")+".beibei.com/item/category-100.html",type:"GET",cache:!0,dataType:"jsonp",jsonpCallback:"BeibeiItemCategoryGet"}).done(function(n){var i=n.main_categorys,a=i.length;if(0!==a){for(var s=0;s<a;s++){var c=i[s].category_name,l=i[s].subdivision_categorys,u=l.length;e+="<li>"+c+"</li>";for(var d=0;d<u;d++){var p="",f="",h=l[d],g=h.target;"search"===g?(p="http://d"+(window.devMode?"-dev":"")+".beibei.com/search/-"+h.operate_cid+".html",f=h.desc):"search_keyword"===g?(p="http://d"+(window.devMode?"-dev":"")+".beibei.com/search/"+encodeURIComponent(h.data)+"-.html",f=h.title):(p=g,f=h.title),t+='<li class="rightCon'+s+'"><a href="'+p+'" clog c-emit="click" c-et="event" c-etl="'+p+'"><img src="'+h.img+'!60x60.jpg" width="60" height="60"><label>'+f+"</label></a></li>"}}t="<div>"+t+"</div>",$(".J_bnCate").html(e),$(".J_bnCate li:last").css("border-bottom",0),o||(r(0),o=!0,$(".J_bnCate li").eq(0).addClass("current"),$(".J_bnCate li").eq(0).css("border-bottom","1px solid #e0e0e0"))}})},searchInput:function(e){window.location.href="http://d/"+(window.devMode?"-dev":"")+".beibei.com/search/"+encodeURIComponent(e)+"-.html"}};var r=function(e){var n=$(t).find(".rightCon"+e),i=n.length;if($(".J_bnCon").html(n),i){var o=i-(i%4||4)-1,r=Math.floor(i/4);i<=4?$(".J_bnCon li").css("border-bottom","0"):$(".J_bnCon li:gt("+o+")").css("border-bottom","0");for(var a=0;a<r;a++)$(".J_bnCon li").eq(4*(a+1)-1).css("border-right","0")}};$(".J_mBnCat").on("mouseenter",function(){var e="",t=$(".J_bnCate li");i||(n.getInfo(),i=!0),$(".J_mBnCon").show(),t.removeClass("current"),t.eq(0).addClass("current"),t.eq(0).css("border-bottom","1px solid #e0e0e0"),r(0)}).on("mouseleave",function(){$(".J_mBnCon").hide()}),$(document).on("mouseenter",".J_bnCate li",function(){var e=$(this),t=e.index();e.hasClass("current")||($(this).addClass("current").siblings().removeClass("current"),$(".J_bnCate li").css("border-bottom","1px solid #ececec"),$(".J_bnCate li:last").css("border-bottom",0),e.css("border-bottom","1px solid #e0e0e0"),$(".J_bnCate li:last").css("border-bottom",0),e.prev().length&&e.prev().css("border-bottom","1px solid #e0e0e0"),r(t))}),$(".J_bnSearchBtn").on("click",function(){var e=$(".J_bnSearchInput").val();return""===$.trim(e)?void $(".J_bnSearchInput").val(""):void n.searchInput(e)})}}(),function(){var e=$(".J_bnSearchInput");if(0!==e.length){var t=function(){var e=$(".J_bn_content"),t=function(e,t,n,i){return['<a href="'+n+'" target="_self" class="m-bn-item analysis-'+i+'">','<span class="m-bn-keyword J_bnKeyword">'+e+"</span>",'<span class="m-bn-memo">'+t+"&gt;</span></a>"].join("")},n="hidden",i=window.devMode?"http://d-dev.beibei.com/":"http://d.beibei.com/",o=window.devMode?"index.htm":"index.htm"/*tpa=http://www.beibei.com/*/,r=-1;return{setContent:function(n){for(var o=26,r="",a=15,s=0;s<n.length&&s<a;s++){var c=n[s];if("brand"===c.source){var l=c.bids&&c.bids.length>0?c.bids[0]:c.bid;r+=t(c.text,"进入品牌",i+window.encodeURIComponent(c.text)+"---"+l+"-hot-1-suggest.html","brand")}else if("category"===c.source){var u=c.cids&&c.cids.length>0?c.cids[0]:c.cid;r+=t(c.text,"进入分类",i+window.encodeURIComponent(c.text)+"--"+c.cid+"--hot-1-suggest.html","category")}else r+=t(c.text,"约"+c.count+"件",i+"search/"+window.encodeURIComponent(c.text)+"-.html","title")}e.html(r).animate({height:26*n.length},100)},init:function(){e.html("").addClass(n).css("height",0),r=-1},show:function(){e.removeClass(n)},hide:function(){e.addClass(n),r=-1},move:function(t){var n=e.find(".m-bn-item");return"0"===n.length?"":("down"===t?(r++,r>n.length-1&&(r=0)):(r--,r<0&&(r=n.length-1)),n.removeClass("m-bn-item-hover"),n.eq(r).addClass("m-bn-item-hover").find(".J_bnKeyword").text())}}}(),n=function(e,t){var i=window.encodeURIComponent(e),o="http://api"+(window.devMode?"-dev":"")+".beibei.com/mroute.html?method=beibei.item.search.suggest&keyword="+i,r=50,a=n.timeout,s=n.cache||(n.cache={});a&&(window.clearTimeout(a),a=null),n.timeout=window.setTimeout(function(){if(e in s)t(s[e]);else{var i=$.Deferred().promise();i=window.isIE7||window.isIE8?$.ajax(o,{type:"GET",dataType:"jsonp",data:{source:"ie"},cache:!0,jsonpCallback:"BeibeiItemSearchSuggest"}):$.ajax(o,{type:"GET",dataType:"json"}),i.done(function(n){s[e]=n,t(n)}),i.fail(function(){console.log("request fail")})}n.timeout=null},r)};e.on("focus",function(){$(this).trigger("keyup")}).on("keyup",function(e){var self=$(this);if(""===self.val())t.init(),window.clearTimeout(n.timeout),n.timeout=null;else if(38===e.keyCode||40===e.keyCode){var i=t.move(38===e.keyCode?"up":"down");i&&self.val(i)}else n(self.val(),function(e){e.search_result&&e.search_result.length>0&&""!==self.val()?(t.show(),t.setContent(e.search_result)):t.init()})}),$(document).on("click",function(e){var n=$(e.target);n.hasClass("J_bnSearchInput")||t.init()}),$(".J_bnSearchInput").on("keydown"http://st.beibei.com/static/build/js/8ac592096em/,function(e){var t=document.all?window.event:e;if(t&&13===t.keyCode){var n=$(".m-bn-item-hover");n.length>0?window.location.href=n.attr("href"):$(".J_bnSearchBtn").click()}})}}(),B.pageControl=B.Page.extend({init:function(){var self=this;self._super(),self.use("fn.setCartNumSubscript"),self.use("fn.initRegBox"),isIE6&&($("#st-nav .dropdown").mouseover(function(){$(this).addClass("hover"),$("ul",this).show()}).mouseleave(function(){$(this).removeClass("hover"),$("ul",this).hide()}),$("#st-nav .dropdown2").mouseover(function(){$(this).addClass("hover"),$(".follow",this).show()}).mouseleave(function(){$(this).removeClass("hover"),$(".follow",this).hide()}))},confSideBarFixedDistance:160,confShowRegBoxHeight:$(window).height(),widget:{sideBarCart:{use:"cartBox",conf:{container:".view-SideBarCart",mode:"trigger",trigger:".view-SideBarCartTrigger",border:!0,triggerPosition:["none",0,-100,-350],cbAfterGetData:function(){}}},topMenuCart:{use:"cartBox",conf:{container:".view-TopMenuCart",hoverGetData:".top-cart",needTitle:!1}}},viewSideBarCartTrigger:null,viewSideBarCartTriggerBtn:null,viewFixedBotbgcloseBtn:null,viewSideBarCart:null,viewRegistrationBox:null,viewMemberBox:null,viewQuickLoginBox:null,viewTopCart:null,viewTopMenuCart:null,viewRecordInfo:null,viewNotShippedClose:null,viewNotShippedIgnore:null,viewSidePhoneApp:null,stCantShowRegBox:!1,stRecordData:[],stNotShippedList:[],onWatch:function(){var self=this;self._super()},onEvent:function(){var self=this;self._super(),self.viewSideBarCartTriggerBtn.on("click",function(e){window.location.href=window.devMode?"http://trade-dev.beibei.com/cart/mine.html":"http://trade.beibei.com/cart/mine.html"}),self.viewFixedBotbgcloseBtn.on("click",function(e){$(this).parent(".fixed-botbg").remove()}),$(document).on("click",self.viewRecordInfo.selector,function(){var e=$(this),t=e.attr("iid")||"",n=e.attr("pageType")||"",i="",o=$.cookie("st_au")||"";i="log=BBItem&au="+o+"&iid="+t+"&pageType="+n,self.use("api.getClickStatistics",i)}),self.viewSidePhoneApp.on("mouseover",function(){$(this).find(".side-panel-phone").show()}).on("mouseout",function(){$(this).find(".side-panel-phone").hide()}),$(document).on("click",self.viewNotShippedClose.selector,function(){self.notShippedBox&&self.notShippedBox.remove()}),$(document).delegate(".detail-url-click","mousedown",function(){var e=$(this),t=e.attr("data-url");"undefined"!=typeof t&&""!==t&&e.attr("href",t)})},api:{getClickStatistics:function(e){var t=window.devMode?"http://dev.beibei.com/click.html?":"http://b.husor.cn/click.html?",n=new Image;$("body").append(n),n.onload=n.onError=function(){$(this).remove()},n.src=t+e},getRegistrationHtml:function(){var self=this;$.ajax({url:"http://"+window.location.host+"/widget/bd/member_popup.api",type:"GET",dataType:"html"}).done(function(e){self.viewRegistrationBox.html(e),self.callIns()})},getMemberBoxHtml:function(e,t){var self=this;e=e||"",$.ajax({url:"http://"+window.location.host+"/widget/member_popup/box_html.api?type="+e+"&cb="+t,type:"GET",dataType:"html"}).done(function(e){self.viewMemberBox.html(e),self.callIns()})},getQuickLoginBoxHtml:function(){var self=this;$.ajax({url:"http://"+window.location.host+"/widget/member_popup/quick_login_html.api",type:"GET",dataType:"html"}).done(function(e){self.viewQuickLoginBox.html(e),self.callIns()})},getNotShippedAddress:{proUrl:"remote_list.html"/*tpa=http://www.beibei.com/location/remote_list.html*/,devUrl:"http://dev.beibei.com/location/remote_list.html",type:"GET",dataType:"jsonp",jsonpCallback:"fn",noHxcsrf:!0,cache:!0,done:function(e){var self=this,t=e.address_list,n=$.cookie("defaddr"),i;self.stNotShippedList=t,_.find(t,function(e){if(i=new RegExp("^"+e),n&&n.replace(i,"").length<6)return self.stNotShipped=!0,!0})}},getAddress:{proUrl:"http://d.beibei.com/location/address_list.html",devUrl:"http://d-dev.beibei.com/location/address_list.html",type:"GET",dataType:"jsonp",cache:!0,jsonpCallback:"getAddress",done:function(e){_.find(e.address_list,function(e,t){if(1===+e.Default)return $.cookie("defaddr",+e.area),!0})}},isRemoteAdderss:function(e,t,n){var self=this,i=JSON.stringify(t),o=window.devMode?"index.htm":"index.htm"/*tpa=http://www.beibei.com/*/,r=o+"trade/order/ajax_check_shipping_region.html?aid="+e+"&items="+i;$.ajax({url:r,type:"GET",dataType:"jsonp",jsonpCallback:"checkAddress"}).done(function(e){if("cart"===n){if(e.items_shipping_limit&&e.items_shipping_limit[0])return e.items_shipping_limit[0][t[0].product_id]?(self.stNotShipped=!0,!0):(self.stNotShipped=!1,!1)}else"pay"===n&&e.items_shipping_limit&&(self.stNotShippedItemId=e.items_shipping_limit,_.each(e.items_shipping_limit,function(e){var t=JSON.stringify(e);t.indexOf("true")!==-1&&(self.stNotShipped=!0)}))})}},view:{showRegistrationBox:function(){var self=this;self.viewRegistrationBox=$('<div class="f-mask view-RegistrationBox"></div>'),$("body").append(self.viewRegistrationBox),self.viewRegistrationBox.css({position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%","z-index":"2002"}),self.use("api.getRegistrationHtml")},hideRegistrationBox:function(){var self=this;self.viewRegistrationBox.remove(),self.stCantShowRegBox=!0},showMemberBox:function(e,t){var self=this;self.viewMemberBox=$('<div class="f-mask view-MemberBox"></div>'),$("body").append(self.viewMemberBox),self.viewMemberBox.css({position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%","z-index":"2002"}),self.use("api.getMemberBoxHtml",e,t)},hideMemberBox:function(){var self=this;self.viewMemberBox.remove()},showQuickLoginBox:function(){var self=this;self.viewQuickLoginBox=$('<div class="f-mask view-QuickLoginBox"></div>'),$("body").append(self.viewQuickLoginBox),self.viewQuickLoginBox.css({position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%","z-index":"2002"}),self.use("api.getQuickLoginBoxHtml")},hideQuickLoginBox:function(){var self=this;self.viewQuickLoginBox.remove()}},ins:{backToTop:function(){$(window).scrollTop(0)}},fn:{getDefaultAddress:function(){var self=this;null===$.cookie("defaddr")?self.useApi("getAddress",{},{done:function(){self.use("fn.setNotShipped")}}):self.use("fn.setNotShipped")},setNotShipped:function(){var self=this;self.useApi("getNotShippedAddress")},judgeRemoteAddress:function(){var self=this,e=window.pageData.itemId,t=window.pageData.productId,n=[{id:e,product_id:t}];self.use("api.isRemoteAdderss",0,n,"cart")},judgePayAddress:function(e,t){var self=this;self.use("api.isRemoteAdderss",e,t,"pay")},setCartNumSubscript:function(){var self=this;self.widgetSideBarCart&&self.widgetSideBarCart.watch("stCartItemNum",function(){self.viewSideBarCartTrigger.find(".cart-num").html(self.widgetSideBarCart.stCartItemNum)})},repairSidePanel:function(e){var self=this,t=$("body"),n=$(window),i=t.height(),o=function(){i=t.height()-n.scrollTop()-n.height(),i+110<=self.confSideBarFixedDistance?e.css({bottom:self.confSideBarFixedDistance-i}):e.css({bottom:110})};n.scroll(o),o()},initRegBox:function(){var self=this;if(_.isNull($.cookie("_last_login_id_"))&&!B.H.isLogin()&&/utm_source/.test(window.location.href)){if(document.all&&!document.querySelector)return self.use("view.showRegistrationBox"),void(self.stCantShowRegBox=!0);var e=$(window),t=$("body"),n=function(){e.scrollTop()>self.confShowRegBoxHeight&&!self.stCantShowRegBox&&!B.H.isLogin()&&(self.use("view.showRegistrationBox"),self.stCantShowRegBox=!0,e.off("scroll",n))};e.on("scroll",n)}return null===$.cookie("_utm_login_")&&!/#BBLogin/.test(window.location.href)||B.H.isLogin()||!_.isNull($.cookie("_last_login_id_"))?void("1"===window.quickLogin&&self.use("view.showQuickLoginBox")):(self.use("view.showRegistrationBox"),self.stCantShowRegBox=!0,void $.cookie("_utm_login_",null))},initMemberBox:function(e,t){t=t||"";var self=this;B.H.isLogin()||$(".f-mask").length>0||self.use("view.showMemberBox",e,t)},hideMemberBox:function(){var self=this;self.use("view.hideMemberBox")}}});